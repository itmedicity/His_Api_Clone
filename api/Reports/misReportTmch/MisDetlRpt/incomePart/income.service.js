// @ts-nocheck
const {oracledb, getTmcConnection} = require("../../../../../config/oradbconfig");

module.exports = {
  // BED INCOME
  bedIncome: async (data, callBack) => {
    let conn_ora = await getTmcConnection();
    const ipNumberList = data?.ptno?.join(",");
    const fromDate = data.from;
    const toDate = data.to;

    const sql = `SELECT INITCAP(Pcc_Desc) Pcc_Desc,
                                        Code,
                                        SUM(Amt) Amt,
                                        SUM(Taxamt) Taxamt
                                FROM(SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(NVL(Svn_Qty * Svn_Rate, 0) - NVL(Svn_Disamt, 0)) Amt,
                                        SUM(NVL(PATSERVICE.SVN_TOTTAX, 0)) Taxamt
                                        FROM Patservice,
                                        Disbillmast,
                                        Prodescription,
                                        Progroup,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Procategory
                                        WHERE     Patservice.Dmc_Slno = Disbillmast.Dmc_Slno
                                        AND Patservice.Pd_Code = Prodescription.Pd_Code
                                        AND Prodescription.Pg_Code = Progroup.Pg_Code
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                        AND Procategory.Pc_Code = Progroup.Pc_Code
                                        AND NVL(Disbillmast.Dmc_Cancel, 'N') = 'N'
                                        AND NVL(Svc_Cancel, 'N') = 'N'
                                        AND Disbillmast.Dmc_Cacr <> 'M'
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND Disbillmast.Dmd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Disbillmast.Dmd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND DISBILLMAST.IP_NO NOT IN(${ipNumberList})
                                        AND DISBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(NVL((Vsn_Rate), 0) - NVL(Vsn_disamt, 0)) Amt,
                                        SUM(NVL(Patvisit.VSN_TOTTAX, 0)) Taxamt
                                        FROM Patvisit,
                                        Disbillmast,
                                        Ipparam,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Procategory
                                        WHERE     Patvisit.Dmc_Slno = Disbillmast.Dmc_Slno
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Vscode
                                        AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                        AND NVL(Disbillmast.Dmc_Cancel, 'N') = 'N'
                                        AND NVL(Vsc_Cancel, 'N') = 'N'
                                        AND Disbillmast.Dmc_Cacr <> 'M'
                                        AND Disbillmast.Dmd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Disbillmast.Dmd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND DISBILLMAST.IP_NO NOT IN(${ipNumberList})
                                        AND DISBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(NVL(Rdn_Amount * Rdn_Days, 0) - NVL(Rdn_Disamt, 0)) Amt,
                                        SUM(NVL(Disrmrentdetl.RDN_TOTTAX, 0)) Taxamt
                                        FROM Disrmrentdetl,
                                        Disbillmast,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Procategory
                                        WHERE     Disrmrentdetl.Dmc_Slno = Disbillmast.Dmc_Slno
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Disrmrentdetl.Pc_Code = Misincexpdtl.Pc_Code
                                        AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Disbillmast.Dmc_Cancel, 'N') = 'N'
                                        AND Disbillmast.Dmc_Cacr <> 'M'
                                        AND Disbillmast.Dmd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Disbillmast.Dmd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND DISBILLMAST.IP_NO NOT IN(${ipNumberList})
                                        AND DISBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(
                                        NVL(disroomdetl.drn_nurdays, 0)
                                        * NVL(disroomdetl.drn_nuramt, 0))
                                                Amt,
                                        SUM(0) Taxamt
                                        FROM Procategory,
                                        ipparam,
                                        disbillmast,
                                        disroomdetl,
                                        Misincexpdtl,
                                        Misincexpgroup
                                        WHERE     disbillmast.dmc_slno = disroomdetl.dmc_slno
                                        AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                        AND Misincexpdtl.Dg_type = 'R'
                                        AND ipparam.ipc_nucode = Misincexpdtl.Pc_code
                                        AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                        AND NVL(Disbillmast.Dmc_cancel, 'N') = 'N'
                                        AND NVL(disroomdetl.dmc_cancel, 'N') = 'N'
                                        AND Disbillmast.Dmc_Cacr <> 'M'
                                        AND Disbillmast.DMD_DATE >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND disbillmast.dmd_date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND DISBILLMAST.IP_NO NOT IN(${ipNumberList})
                                        AND DISBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(NVL(Iprefunditemdetl.Rin_Netamt, 0)) * -1 Amt,
                                        SUM(NVL(Iprefunditemdetl.RIN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Misincexpgroup,
                                        Misincexpdtl,
                                        Iprefunditemdetl,
                                        Iprefundmast,
                                        Procategory
                                        WHERE     Iprefundmast.Ric_Slno = Iprefunditemdetl.Ric_Slno
                                        AND Iprefunditemdetl.Pc_Code = Procategory.Pc_Code
                                        AND Iprefunditemdetl.Pc_Code = Misincexpdtl.Pc_Code
                                        AND Misincexpgroup.Dg_Grcode = Misincexpdtl.Dg_Grcode
                                        AND Misincexpgroup.Dg_Type = 'R'
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND Iprefunditemdetl.Ric_Type <> 'PHY'
                                        AND Iprefundmast.Ric_Cacr IN('C', 'R')
                                        AND NVL(Iprefundmast.Ric_Cancel, 'N') = 'N'
                                        AND Iprefundmast.Rid_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Iprefundmast.Rid_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND IPREFUNDMAST.IP_NO NOT IN(${ipNumberList})
                                        AND IPREFUNDMAST.MH_CODE IN
                                        (SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(
                                        NVL(Srn_Operation, 0) - (NVL(Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                        SUM(NVL(PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                        Patsurgery,
                                        Ipparam,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Oper
                                        AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                        AND NVL(Patsurgery.Srn_Operation, 0) > 0
                                        AND Misincexpdtl.Dg_grcode = 2
                                        AND NVL(Patsurgery.Src_Cancel, 'N') = 'N'
                                        AND NVL(Disbillmast.Dmc_Cancel, 'N') = 'N'
                                        AND Disbillmast.Dmc_Cacr <> 'M'
                                        AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                        AND Disbillmast.Dmd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Disbillmast.Dmd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND DISBILLMAST.IP_NO NOT IN(${ipNumberList})
                                        AND DISBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(
                                        NVL(Srn_Theater, 0) - (NVL(Patsurgery.Srn_Theardis, 0)))
                                                Amt,
                                        SUM(NVL(PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                        Patsurgery,
                                        Ipparam,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Ther
                                        AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Patsurgery.Srn_Theater, 0) > 0
                                        AND NVL(Patsurgery.Src_Cancel, 'N') = 'N'
                                        AND NVL(Disbillmast.Dmc_Cancel, 'N') = 'N'
                                        AND Disbillmast.Dmc_Cacr <> 'M'
                                        AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                        AND Disbillmast.Dmd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Disbillmast.Dmd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND DISBILLMAST.IP_NO NOT IN(${ipNumberList})
                                        AND DISBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(NVL(Srn_Chief, 0)) Amt,
                                        SUM(NVL(PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                        Patsurgery,
                                        Ipparam,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Procategory,
                                        PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                        AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Chief
                                        AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Patsurgery.Srn_Chief, 0) > 0
                                        AND NVL(Patsurgery.Src_Cancel, 'N') = 'N'
                                        AND NVL(Disbillmast.Dmc_Cancel, 'N') = 'N'
                                        AND Disbillmast.Dmc_Cacr <> 'M'
                                        AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                        AND Disbillmast.Dmd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Disbillmast.Dmd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND DISBILLMAST.IP_NO NOT IN(${ipNumberList})
                                        AND DISBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(NVL(Srn_1Stasst, 0)) Amt,
                                        SUM(NVL(PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                        Patsurgery,
                                        Ipparam,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Procategory,
                                        PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                        AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Ipparam.Ipc_1Stasst
                                        AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Patsurgery.Srn_1Stasst, 0) > 0
                                        AND NVL(Patsurgery.Src_Cancel, 'N') = 'N'
                                        AND NVL(Disbillmast.Dmc_Cancel, 'N') = 'N'
                                        AND Disbillmast.Dmc_Cacr <> 'M'
                                        AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                        AND Disbillmast.Dmd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Disbillmast.Dmd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND DISBILLMAST.IP_NO NOT IN(${ipNumberList})
                                        AND DISBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(NVL(Srn_2Ndasst, 0)) Amt,
                                        SUM(NVL(PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                        Patsurgery,
                                        Ipparam,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Procategory,
                                        PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                        AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Ipparam.Ipc_2Ndasst
                                        AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Patsurgery.Srn_2Ndasst, 0) > 0
                                        AND NVL(Patsurgery.Src_Cancel, 'N') = 'N'
                                        AND NVL(Disbillmast.Dmc_Cancel, 'N') = 'N'
                                        AND Disbillmast.Dmc_Cacr <> 'M'
                                        AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                        AND Disbillmast.Dmd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Disbillmast.Dmd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND DISBILLMAST.IP_NO NOT IN(${ipNumberList})
                                        AND DISBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(NVL(Srn_3Rdasst, 0)) Amt,
                                        SUM(NVL(PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                        Patsurgery,
                                        Ipparam,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Procategory,
                                        PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                        AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Ipparam.Ipc_3Rdasst
                                        AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Patsurgery.Srn_3Rdasst, 0) > 0
                                        AND NVL(Patsurgery.Src_Cancel, 'N') = 'N'
                                        AND NVL(Disbillmast.Dmc_Cancel, 'N') = 'N'
                                        AND Disbillmast.Dmc_Cacr <> 'M'
                                        AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                        AND Disbillmast.Dmd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Disbillmast.Dmd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND DISBILLMAST.IP_NO NOT IN(${ipNumberList})
                                        AND DISBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(NVL(Srn_Guest, 0)) Amt,
                                        SUM(NVL(PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                        Patsurgery,
                                        Ipparam,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Procategory,
                                        PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                        AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Guest
                                        AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Patsurgery.Srn_Guest, 0) > 0
                                        AND NVL(Patsurgery.Src_Cancel, 'N') = 'N'
                                        AND NVL(Disbillmast.Dmc_Cancel, 'N') = 'N'
                                        AND Disbillmast.Dmc_Cacr <> 'M'
                                        AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                        AND Disbillmast.Dmd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Disbillmast.Dmd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND DISBILLMAST.IP_NO NOT IN(${ipNumberList})
                                        AND DISBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(NVL(Srn_Antest, 0) - NVL(Srn_Antdis, 0)) Amt,
                                        SUM(NVL(PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                        Patsurgery,
                                        Ipparam,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Procategory,
                                        PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                        AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest
                                        AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Patsurgery.Srn_Antest, 0) > 0
                                        AND NVL(Patsurgery.Src_Cancel, 'N') = 'N'
                                        AND NVL(Disbillmast.Dmc_Cancel, 'N') = 'N'
                                        AND Disbillmast.Dmc_Cacr <> 'M'
                                        AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                        AND Disbillmast.Dmd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Disbillmast.Dmd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND DISBILLMAST.IP_NO NOT IN(${ipNumberList})
                                        AND DISBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(NVL(Srn_Antest2, 0)) Amt,
                                        SUM(NVL(PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                        Patsurgery,
                                        Ipparam,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Procategory,
                                        PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                        AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest2
                                        AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Patsurgery.Srn_Antest2, 0) > 0
                                        AND NVL(Patsurgery.Src_Cancel, 'N') = 'N'
                                        AND NVL(Disbillmast.Dmc_Cancel, 'N') = 'N'
                                        AND Disbillmast.Dmc_Cacr <> 'M'
                                        AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                        AND Disbillmast.Dmd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Disbillmast.Dmd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND DISBILLMAST.IP_NO NOT IN(${ipNumberList})
                                        AND DISBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(NVL(Patsurother.Pdn_Amount, 0)) Amt,
                                        SUM(NVL(PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                        Patsurgery,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Patsurother,
                                        Prodescription,
                                        Progroup,
                                        Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                        AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                        AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                        AND Prodescription.Pg_Code = Progroup.Pg_Code
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                        AND Progroup.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Patsurgery.Src_Cancel, 'N') = 'N'
                                        AND NVL(Disbillmast.Dmc_Cancel, 'N') = 'N'
                                        AND Disbillmast.Dmc_Cacr <> 'M'
                                        AND Disbillmast.Dmd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Disbillmast.Dmd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND DISBILLMAST.IP_NO NOT IN(${ipNumberList})
                                        AND DISBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                        AND NVL(Patsurother.Src_Cancel, 'N') = 'N'
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(Patsurdetl.Srn_Amount - NVL(Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                        SUM(NVL(patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                        Patsurgery,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Patsurdetl,
                                        Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                        AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                        AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Patsurgery.Src_Cancel, 'N') = 'N'
                                        AND NVL(Disbillmast.Dmc_Cancel, 'N') = 'N'
                                        AND Disbillmast.Dmc_Cacr <> 'M'
                                        AND Disbillmast.Dmd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Disbillmast.Dmd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND DISBILLMAST.IP_NO NOT IN(${ipNumberList})
                                        AND DISBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                        AND NVL(Patsurdetl.Src_Cancel, 'N') = 'N'
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(NVL(Cmn_Netamt, 0) - NVL(Cmn_Outcoll, 0)) Amt,
                                        SUM(0) Taxamt
                                        FROM Canbillmast,
                                        Disbillmast,
                                        Ipparam,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Procategory
                                        WHERE     Canbillmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Canteencode
                                        AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                        AND NVL(Disbillmast.Dmc_Cancel, 'N') = 'N'
                                        AND NVL(Canbillmast.Cmc_Cancel, 'N') = 'N'
                                        AND Canbillmast.Cmc_Cacr = 'I'
                                        AND Disbillmast.Dmc_Cacr <> 'M'
                                        AND Disbillmast.Dmd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Disbillmast.Dmd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND DISBILLMAST.IP_NO NOT IN(${ipNumberList})
                                        AND DISBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(
                                        NVL(Srn_Operation, 0) - (NVL(Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                        SUM(NVL(PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                        Patsurgery,
                                        Opparam,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Procategory
                                        WHERE     Patsurgery.Operation_Opslno = Opbillmast.Opc_Slno
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Opparam.Opc_Oper
                                        AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Patsurgery.Srn_Operation, 0) > 0
                                        AND NVL(Patsurgery.Src_Cancel, 'N') = 'N'
                                        AND NVL(Opbillmast.Opn_Cancel, 'N') = 'N'
                                        AND Opbillmast.Opc_Cacr <> 'M'
                                        AND Opbillmast.Opd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Opbillmast.Opd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND PATSURGERY.IP_NO NOT IN(${ipNumberList})
                                        AND OPBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(
                                        NVL(Srn_Theater, 0) - (NVL(Patsurgery.Srn_Theardis, 0)))
                                                Amt,
                                        SUM(NVL(PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                        Patsurgery,
                                        Opparam,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Procategory
                                        WHERE     Patsurgery.Theater_Opslno = Opbillmast.Opc_Slno
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Opparam.Opc_Ther
                                        AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Patsurgery.Srn_Theater, 0) > 0
                                        AND NVL(Patsurgery.Src_Cancel, 'N') = 'N'
                                        AND NVL(Opbillmast.Opn_Cancel, 'N') = 'N'
                                        AND Opbillmast.Opc_Cacr <> 'M'
                                        AND Opbillmast.Opd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Opbillmast.Opd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND PATSURGERY.IP_NO NOT IN(${ipNumberList})
                                        AND OPBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(NVL(Srn_Chief, 0)) Amt,
                                        SUM(NVL(PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                        Patsurgery,
                                        Opparam,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Procategory,
                                        PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Chief_Opslno = Opbillmast.Opc_Slno
                                        AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Opparam.Opc_Chief
                                        AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Patsurgery.Srn_Chief, 0) > 0
                                        AND NVL(Patsurgery.Src_Cancel, 'N') = 'N'
                                        AND NVL(Opbillmast.Opn_Cancel, 'N') = 'N'
                                        AND Opbillmast.Opc_Cacr <> 'M'
                                        AND Opbillmast.Opd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Opbillmast.Opd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND PATSURGERY.IP_NO NOT IN(${ipNumberList})
                                        AND OPBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(NVL(Srn_1Stasst, 0)) Amt,
                                        SUM(NVL(PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                        Patsurgery,
                                        Opparam,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Procategory,
                                        PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D1Stasst_Opslno = Opbillmast.Opc_Slno
                                        AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Opparam.Opc_1Stasst
                                        AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Patsurgery.Srn_1Stasst, 0) > 0
                                        AND NVL(Patsurgery.Src_Cancel, 'N') = 'N'
                                        AND NVL(Opbillmast.Opn_Cancel, 'N') = 'N'
                                        AND Opbillmast.Opc_Cacr <> 'M'
                                        AND Opbillmast.Opd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Opbillmast.Opd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND PATSURGERY.IP_NO NOT IN(${ipNumberList})
                                        AND OPBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(NVL(Srn_2Ndasst, 0)) Amt,
                                        SUM(NVL(PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                        Patsurgery,
                                        Opparam,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Procategory,
                                        PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D2Ndasst_Opslno = Opbillmast.Opc_Slno
                                        AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Opparam.Opc_2Ndasst
                                        AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Patsurgery.Srn_2Ndasst, 0) > 0
                                        AND NVL(Patsurgery.Src_Cancel, 'N') = 'N'
                                        AND NVL(Opbillmast.Opn_Cancel, 'N') = 'N'
                                        AND Opbillmast.Opc_Cacr <> 'M'
                                        AND Opbillmast.Opd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Opbillmast.Opd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND PATSURGERY.IP_NO NOT IN(${ipNumberList})
                                        AND OPBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(NVL(Srn_3Rdasst, 0)) Amt,
                                        SUM(NVL(PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                        Patsurgery,
                                        Opparam,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Procategory,
                                        PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D3Rdasst_Opslno = Opbillmast.Opc_Slno
                                        AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Opparam.Opc_3Rdasst
                                        AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Patsurgery.Srn_3Rdasst, 0) > 0
                                        AND NVL(Patsurgery.Src_Cancel, 'N') = 'N'
                                        AND NVL(Opbillmast.Opn_Cancel, 'N') = 'N'
                                        AND Opbillmast.Opc_Cacr <> 'M'
                                        AND Opbillmast.Opd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Opbillmast.Opd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND PATSURGERY.IP_NO NOT IN(${ipNumberList})
                                        AND OPBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(NVL(Srn_Guest, 0)) Amt,
                                        SUM(NVL(PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                        Patsurgery,
                                        Opparam,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Procategory,
                                        PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Guest_Opslno = Opbillmast.Opc_Slno
                                        AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Opparam.Opc_Guest
                                        AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Patsurgery.Srn_Guest, 0) > 0
                                        AND NVL(Patsurgery.Src_Cancel, 'N') = 'N'
                                        AND NVL(Opbillmast.Opn_Cancel, 'N') = 'N'
                                        AND Opbillmast.Opc_Cacr <> 'M'
                                        AND Opbillmast.Opd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Opbillmast.Opd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND PATSURGERY.IP_NO NOT IN(${ipNumberList})
                                        AND OPBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(NVL(Srn_Antest, 0) - NVL(Srn_Antdis, 0)) Amt,
                                        SUM(NVL(PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                        Patsurgery,
                                        Opparam,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Procategory,
                                        PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest_Opslno = Opbillmast.Opc_Slno
                                        AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest
                                        AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Patsurgery.Srn_Antest, 0) > 0
                                        AND NVL(Patsurgery.Src_Cancel, 'N') = 'N'
                                        AND NVL(Opbillmast.Opn_Cancel, 'N') = 'N'
                                        AND Opbillmast.Opc_Cacr <> 'M'
                                        AND Opbillmast.Opd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Opbillmast.Opd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND PATSURGERY.IP_NO NOT IN(${ipNumberList})
                                        AND OPBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(NVL(Srn_Antest2, 0)) Amt,
                                        SUM(NVL(PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                        Patsurgery,
                                        Opparam,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Procategory,
                                        PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest2_Opslno = Opbillmast.Opc_Slno
                                        AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest2
                                        AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Patsurgery.Srn_Antest2, 0) > 0
                                        AND NVL(Patsurgery.Src_Cancel, 'N') = 'N'
                                        AND NVL(Opbillmast.Opn_Cancel, 'N') = 'N'
                                        AND Opbillmast.Opc_Cacr <> 'M'
                                        AND Opbillmast.Opd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Opbillmast.Opd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND PATSURGERY.IP_NO NOT IN(${ipNumberList})
                                        AND OPBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(NVL(Patsurother.Pdn_Amount, 0)) Amt,
                                        SUM(NVL(PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                        Patsurgery,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Patsurother,
                                        Prodescription,
                                        Progroup,
                                        Procategory
                                        WHERE     Patsurother.Opc_Slno = Opbillmast.Opc_Slno
                                        AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                        AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                        AND Prodescription.Pg_Code = Progroup.Pg_Code
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                        AND Progroup.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Patsurgery.Src_Cancel, 'N') = 'N'
                                        AND NVL(Opbillmast.Opn_Cancel, 'N') = 'N'
                                        AND Opbillmast.Opc_Cacr <> 'M'
                                        AND Opbillmast.Opd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Opbillmast.Opd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND PATSURGERY.IP_NO NOT IN(${ipNumberList})
                                        AND OPBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                        AND NVL(Patsurother.Src_Cancel, 'N') = 'N'
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(Patsurdetl.Srn_Amount - NVL(Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                        SUM(NVL(patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                        Patsurgery,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Patsurdetl,
                                        Procategory
                                        WHERE     Patsurdetl.Opc_Slno = Opbillmast.Opc_Slno
                                        AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                        AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Patsurgery.Src_Cancel, 'N') = 'N'
                                        AND NVL(Opbillmast.Opn_Cancel, 'N') = 'N'
                                        AND Opbillmast.Opc_Cacr <> 'M'
                                        AND Opbillmast.Opd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Opbillmast.Opd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND PATSURGERY.IP_NO NOT IN(${ipNumberList})
                                        AND OPBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                        AND NVL(Patsurdetl.Src_Cancel, 'N') = 'N'
                                GROUP BY Procategory.Pc_Code, Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(NVL(Receiptdetl.Rpn_Netamt, 0)) Amt,
                                        SUM(NVL(RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                        Receiptmast,
                                        Prodescription,
                                        Progroup,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                        AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                        AND Prodescription.Pg_Code = Progroup.Pg_Code
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                        AND Progroup.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Receiptmast.Rpc_Cancel, 'N') <> 'C'
                                        AND Receiptmast.RPC_COLLCNCODE IS NULL
                                        AND Receiptmast.Rpc_Cacr IN('C', 'R')
                                        AND Receiptmast.Rpd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Receiptmast.Rpd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND RECEIPTMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(NVL(Receiptdetl.Rpn_Netamt, 0)) Amt,
                                        SUM(NVL(RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                        Receiptmast,
                                        Prodescription,
                                        Progroup,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                        AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                        AND Prodescription.Pg_Code = Progroup.Pg_Code
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                        AND Progroup.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND Receiptmast.Rpc_Cancel IS NULL
                                        AND Receiptmast.RPC_COLLCNCODE IS NOT NULL
                                        AND Receiptmast.Rpc_Cacr IN('C', 'R')
                                        AND Receiptmast.RPD_COLLDATE >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Receiptmast.RPD_COLLDATE <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND RECEIPTMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(Receiptdetl.Rpn_Netamt) Amt,
                                        SUM(NVL(RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                        Receiptmast,
                                        Prodescription,
                                        Progroup,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Opbillmast,
                                        procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                        AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                        AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                        AND Prodescription.Pg_Code = Progroup.Pg_Code
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                        AND Progroup.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND Receiptmast.Rpc_Cancel IS NULL
                                        AND NVL(Opbillmast.Opn_Cancel, 'N') = 'N'
                                        AND Receiptmast.Rpc_Cacr = 'O'
                                        AND Opbillmast.Opc_cacr <> 'M'
                                        AND Opbillmast.Opd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Opbillmast.Opd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND RECEIPTMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                        SUM(NVL(refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                        Refundreceiptmast,
                                        Prodescription,
                                        Progroup,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                        AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                        AND Prodescription.Pg_Code = Progroup.Pg_Code
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                        AND Progroup.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Refundreceiptmast.Rfc_Cancel, 'N') <> 'C'
                                        AND Refundreceiptmast.RFC_RETCNCODE IS NULL
                                        AND Refundreceiptmast.Rfc_Cacr IN('C', 'R')
                                        AND Refundreceiptdetl.Rfd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Refundreceiptdetl.Rfd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND REFUNDRECEIPTMAST.MH_CODE IN
                                        (SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                        SUM(NVL(refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                        Refundreceiptmast,
                                        Prodescription,
                                        Progroup,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                        AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                        AND Prodescription.Pg_Code = Progroup.Pg_Code
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                        AND Progroup.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND Refundreceiptmast.RFC_RETCNCODE IS NOT NULL
                                        AND Refundreceiptmast.Rfc_Cancel IS NULL
                                        AND Refundreceiptmast.Rfc_Cacr IN('C', 'R')
                                        AND Refundreceiptmast.RFD_RETDATE >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Refundreceiptmast.RFD_RETDATE <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND REFUNDRECEIPTMAST.MH_CODE IN
                                        (SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                        SUM(NVL(refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                        refundreceiptmast,
                                        Receiptdetl,
                                        Opbillmast,
                                        Prodescription,
                                        Progroup,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Procategory
                                        WHERE     Refundreceiptdetl.Rpc_Slno = Receiptdetl.Rpc_Slno
                                        AND Refundreceiptdetl.Rpc_Cnt = Receiptdetl.Rpc_Cnt
                                        AND REFUNDRECEIPTMAST.Rfc_Slno = REFUNDRECEIPTDETL.Rfc_Slno
                                        AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                        AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                        AND Prodescription.Pg_Code = Progroup.Pg_Code
                                        AND Progroup.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                        AND Misincexpdtl.Dg_type = 'R'
                                        AND Misincexpdtl.Pc_code = progroup.pc_code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Opbillmast.Opn_Cancel, 'N') = 'N'
                                        AND NVL(Refundreceiptdetl.Rfc_Cancel, 'N') = 'N'
                                        AND REFUNDRECEIPTMAST.RFC_CAcr IN('O')
                                        AND Opbillmast.Opc_Cacr <> 'M'
                                        AND Opbillmast.Opd_date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Opbillmast.Opd_date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND OPBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(
                                        (Billdetl.Pdn_Rate * Pdn_Qty)
                                        - NVL(Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                        SUM(NVL(BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                        Billdetl,
                                        Misincexpdtl,
                                        Prodescription,
                                        Progroup,
                                        Misincexpgroup,
                                        Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                        AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                        AND Prodescription.Pg_Code = Progroup.Pg_Code
                                        AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                        AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Billmast.Bmc_Cacr IN('C', 'R')
                                        AND NVL(Billmast.Bmc_Cancel, 'N') <> 'C'
                                        AND billmast.BMC_COLLCNCODE IS NULL
                                        AND Billmast.Bmd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Billmast.Bmd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND BILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(
                                        (Billdetl.Pdn_Rate * Pdn_Qty)
                                        - NVL(Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                        SUM(NVL(BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                        Billdetl,
                                        Misincexpdtl,
                                        Prodescription,
                                        Progroup,
                                        Misincexpgroup,
                                        Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                        AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                        AND Prodescription.Pg_Code = Progroup.Pg_Code
                                        AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                        AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND billmast.BMC_COLLCNCODE IS NOT NULL
                                        AND Billmast.Bmc_Cacr IN('C', 'R')
                                        AND NVL(Billmast.Bmc_Cancel, 'N') = 'N'
                                        AND Billmast.BMD_COLLDATE >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Billmast.BMD_COLLDATE <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND BILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(
                                        (Billdetl.Pdn_Rate * Pdn_Qty)
                                        - NVL(Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                        SUM(NVL(BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                        Billmast,
                                        Prodescription,
                                        Progroup,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Opbillmast,
                                        Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                        AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                        AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                        AND Prodescription.Pg_Code = Progroup.Pg_Code
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                        AND Progroup.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND Opbillmast.Opc_Cacr <> 'M'
                                        AND Billmast.Bmc_Cacr = 'O'
                                        AND NVL(Billmast.Bmc_Cancel, 'N') = 'N'
                                        AND NVL(Opbillmast.Opn_Cancel, 'N') = 'N'
                                        AND Opbillmast.Opd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Opbillmast.Opd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND BILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(
                                        (Billdetl.Pdn_Rate * Pdn_Qty)
                                        - NVL(Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                        SUM(NVL(BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                        Billmast,
                                        Prodescription,
                                        Progroup,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Disbillmast,
                                        Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                        AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                        AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                        AND Prodescription.Pg_Code = Progroup.Pg_Code
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                        AND Progroup.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND Disbillmast.Dmc_Cacr <> 'M'
                                        AND Billmast.Bmc_Cacr = 'I'
                                        AND NVL(Billmast.Bmc_Cancel, 'N') = 'N'
                                        AND NVL(Disbillmast.Dmc_Cancel, 'N') = 'N'
                                        AND Disbillmast.Dmd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Disbillmast.Dmd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND BILLMAST.IP_NO NOT IN(${ipNumberList})
                                        AND BILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                        SUM(NVL(refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                        Refundbillmast,
                                        Prodescription,
                                        Progroup,
                                        Misincexpdtl,
                                        Misincexpgroup,
                                        Billmast,
                                        Procategory
                                        WHERE     Billmast.Bmc_Slno = Refundbillmast.Bmc_Slno
                                        AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                        AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                        AND Prodescription.Pg_Code = Progroup.Pg_Code
                                        AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                        AND Misincexpdtl.Dg_Type = 'R'
                                        AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                        AND Progroup.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Refundbillmast.Rfc_Cancel, 'N') <> 'C'
                                        AND Refundbillmast.Rfc_Cacr IN('C', 'R')
                                        AND Refundbilldetl.Rfd_Date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Refundbilldetl.Rfd_Date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND BILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                        SUM(NVL(refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                        Refundbillmast,
                                        Billdetl,
                                        Opbillmast,
                                        Prodescription,
                                        Progroup,
                                        Procategory,
                                        Misincexpdtl,
                                        Misincexpgroup
                                        WHERE     Refundbilldetl.Bmc_Slno = Billdetl.Bmc_Slno
                                        AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                        AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                        AND Refundbilldetl.Bmc_Cnt = Billdetl.Bmc_Cnt
                                        AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                        AND Prodescription.Pg_Code = Progroup.Pg_Code
                                        AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                        AND Misincexpdtl.Dg_type = 'R'
                                        AND Misincexpdtl.Pc_code = progroup.pc_code
                                        AND Progroup.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND Refundbillmast.Rfc_Cacr IN('O')
                                        AND NVL(Opbillmast.Opn_Cancel, 'N') = 'N'
                                        AND NVL(Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                        AND Opbillmast.Opc_Cacr <> 'M'
                                        AND Opbillmast.Opd_date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Opbillmast.Opd_date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND OPBILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                        SUM(NVL(refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Billmast,
                                        Refundbilldetl,
                                        Refundbillmast,
                                        Disbillmast,
                                        Prodescription,
                                        Progroup,
                                        Procategory,
                                        Misincexpdtl,
                                        Misincexpgroup
                                        WHERE     Billmast.Bmc_Slno = Refundbilldetl.Bmc_Slno
                                        AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                        AND Refundbilldetl.Pd_Code = Prodescription.Pd_code
                                        AND Prodescription.Pg_code = Progroup.Pg_code
                                        AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                        AND Misincexpdtl.Dg_type = 'R'
                                        AND Misincexpdtl.Pc_code = progroup.pc_code
                                        AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                        AND Progroup.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Disbillmast.Dmc_Cancel, 'N') = 'N'
                                        AND NVL(Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                        AND Refundbillmast.Rfc_Cacr IN('I')
                                        AND Disbillmast.Dmc_Cacr <> 'M'
                                        AND Disbillmast.dmd_date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Disbillmast.dmd_date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND DISBILLMAST.IP_NO NOT IN(${ipNumberList})
                                        AND BILLMAST.MH_CODE IN(SELECT MH_CODE FROM multihospital)
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                UNION ALL
                                SELECT Procategory.Pcc_Desc,
                                        Procategory.Pc_Code AS Code,
                                        SUM(NVL(DSN_PACKAGEADJAMT, 0)) Amt,
                                        SUM(0) Taxamt
                                        FROM Disbillmast,
                                        Disbilldetl,
                                        Procategory,
                                        Misincexpdtl,
                                        Misincexpgroup
                                        WHERE     Disbillmast.dmc_Slno = Disbilldetl.dmc_Slno
                                        AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                        AND Misincexpdtl.Dg_type = 'R'
                                        AND Misincexpdtl.Pc_code = Disbilldetl.pc_code
                                        AND Disbilldetl.Pc_Code = Procategory.Pc_Code
                                        AND Misincexpdtl.Dg_Grcode = 2
                                        AND NVL(Disbillmast.Dmc_Cancel, 'N') = 'N'
                                        AND Disbillmast.Dmc_Cacr <> 'M'
                                        AND Disbillmast.dmd_date >=
                                TO_DATE('${fromDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Disbillmast.dmd_date <=
                                TO_DATE('${toDate}',
                                        'dd/MM/yyyy hh24:mi:ss')
                                                        AND DISBILLMAST.IP_NO NOT IN(${ipNumberList})
                                GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc)
                                GROUP BY Code, Pcc_Desc
                                HAVING SUM(Amt) <> 0
                                ORDER BY Pcc_Desc`;
    try {
      const result = await conn_ora.execute(sql, {}, {outFormat: oracledb.OUT_FORMAT_OBJECT});
      callBack(err, result.rows);
    } catch (error) {
      console.log(error);
    } finally {
      if (conn_ora) await conn_ora.close();
    }
  },
  nsIncome: async (data, callBack) => {
    let conn_ora = await getTmcConnection();

    const ipNumberList = data.ptno.join(",");
    const fromDate = data.from;
    const toDate = data.to;

    const sql = `SELECT INITCAP (Pcc_Desc) Pcc_Desc,
                                        Code,
                                        SUM (Amt) Amt,
                                        SUM (Taxamt) Taxamt
                                FROM (  
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Svn_Qty * Svn_Rate, 0) - NVL (Svn_Disamt, 0)) Amt,
                                                SUM (NVL (PATSERVICE.SVN_TOTTAX, 0)) Taxamt
                                                FROM Patservice,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patservice.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patservice.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Procategory.Pc_Code = Progroup.Pc_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Svc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL ( (Vsn_Rate), 0) - NVL (Vsn_disamt, 0)) Amt,
                                                SUM (NVL (Patvisit.VSN_TOTTAX, 0)) Taxamt
                                                FROM Patvisit,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patvisit.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Vscode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Vsc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})                
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Rdn_Amount * Rdn_Days, 0) - NVL (Rdn_Disamt, 0)) Amt,
                                                SUM (NVL (Disrmrentdetl.RDN_TOTTAX, 0)) Taxamt
                                                FROM Disrmrentdetl,
                                                Disbillmast,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Disrmrentdetl.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Disrmrentdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                        NVL (disroomdetl.drn_nurdays, 0)
                                                        * NVL (disroomdetl.drn_nuramt, 0))
                                                        Amt,
                                                SUM (0) Taxamt
                                                FROM Procategory,
                                                ipparam,
                                                disbillmast,
                                                disroomdetl,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     disbillmast.dmc_slno = disroomdetl.dmc_slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND ipparam.ipc_nucode = Misincexpdtl.Pc_code
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_cancel, 'N') = 'N'
                                                AND NVL (disroomdetl.dmc_cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.DMD_DATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Iprefunditemdetl.Rin_Netamt, 0)) * -1 Amt,
                                                SUM (NVL (Iprefunditemdetl.RIN_TOTTAX, 0)) * -1 Taxamt
                                                FROM Misincexpgroup,
                                                Misincexpdtl,
                                                Iprefunditemdetl,
                                                Iprefundmast,
                                                Procategory
                                        WHERE     Iprefundmast.Ric_Slno = Iprefunditemdetl.Ric_Slno
                                                AND Iprefunditemdetl.Pc_Code = Procategory.Pc_Code
                                                AND Iprefunditemdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpgroup.Dg_Grcode = Misincexpdtl.Dg_Grcode
                                                AND Misincexpgroup.Dg_Type = 'R'
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND Iprefunditemdetl.Ric_Type <> 'PHY'
                                                AND Iprefundmast.Ric_Cacr IN ('C', 'R')
                                                AND NVL (Iprefundmast.Ric_Cancel, 'N') = 'N'
                                                AND Iprefundmast.Rid_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Iprefundmast.Rid_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND IPREFUNDMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                        NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                        Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                                FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND Misincexpdtl.Dg_grcode = 12
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                        NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                        Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                                FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_2Ndasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                        AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})       
                                        AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                                FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                        Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                                FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Cmn_Netamt, 0) - NVL (Cmn_Outcoll, 0)) Amt,
                                                SUM (0) Taxamt
                                                FROM Canbillmast,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Canbillmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Canteencode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Canbillmast.Cmc_Cancel, 'N') = 'N'
                                                AND Canbillmast.Cmc_Cacr = 'I'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                        NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                        Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                                FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Operation_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                        NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                        Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                                FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Theater_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Chief_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D1Stasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D2Ndasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_2Ndasst
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D3Rdasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Guest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest2_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                                FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurother.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                        Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                                FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                                FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Receiptmast.Rpc_Cancel, 'N') <> 'C'
                                                AND Receiptmast.RPC_COLLCNCODE IS NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.Rpd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.Rpd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                                FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND Receiptmast.RPC_COLLCNCODE IS NOT NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.RPD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.RPD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Receiptdetl.Rpn_Netamt) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                                FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Receiptmast.Rpc_Cacr = 'O'
                                                AND Opbillmast.Opc_cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=TO_DATE ('${fromDate}','dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=TO_DATE ('${toDate}','dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                                FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Refundreceiptmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptdetl.Rfd_Date >=TO_DATE ('${fromDate}','dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptdetl.Rfd_Date <=TO_DATE ('${toDate}','dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                                FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NOT NULL
                                                AND Refundreceiptmast.Rfc_Cancel IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptmast.RFD_RETDATE >=TO_DATE ('${fromDate}','dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptmast.RFD_RETDATE <=TO_DATE ('${toDate}','dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                                FROM Refundreceiptdetl,
                                                refundreceiptmast,
                                                Receiptdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptdetl.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Refundreceiptdetl.Rpc_Cnt = Receiptdetl.Rpc_Cnt
                                                AND REFUNDRECEIPTMAST.Rfc_Slno = REFUNDRECEIPTDETL.Rfc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundreceiptdetl.Rfc_Cancel, 'N') = 'N'
                                                AND REFUNDRECEIPTMAST.RFC_CAcr IN ('O')
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=TO_DATE ('${fromDate}','dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=TO_DATE ('${toDate}','dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                        (Billdetl.Pdn_Rate * Pdn_Qty)
                                                        - NVL (Billdetl.Bmn_Disamt, 0))
                                                        Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                                FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') <> 'C'
                                                AND billmast.BMC_COLLCNCODE IS NULL
                                                AND Billmast.Bmd_Date >=TO_DATE ('${fromDate}','dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.Bmd_Date <=TO_DATE ('${toDate}','dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                        (Billdetl.Pdn_Rate * Pdn_Qty)
                                                        - NVL (Billdetl.Bmn_Disamt, 0))
                                                        Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                                FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND billmast.BMC_COLLCNCODE IS NOT NULL
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND Billmast.BMD_COLLDATE >=TO_DATE ('${fromDate}','dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.BMD_COLLDATE <=TO_DATE ('${toDate}','dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                        (Billdetl.Pdn_Rate * Pdn_Qty)
                                                        - NVL (Billdetl.Bmn_Disamt, 0))
                                                        Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                                FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'O'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opd_Date >=TO_DATE ('${fromDate}','dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=TO_DATE ('${toDate}','dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND Billmast.IP_NO NOT IN (${ipNumberList})
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                        (Billdetl.Pdn_Rate * Pdn_Qty)
                                                        - NVL (Billdetl.Bmn_Disamt, 0))
                                                        Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                                FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Disbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'I'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmd_Date >=TO_DATE ('${fromDate}','dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=TO_DATE ('${toDate}','dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                                FROM Refundbilldetl,
                                                Refundbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Billmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Refundbillmast.Bmc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Refundbillmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundbillmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundbilldetl.Rfd_Date >= TO_DATE ('${fromDate}','dd/MM/yyyy hh24:mi:ss')
                                                AND Refundbilldetl.Rfd_Date <= TO_DATE ('${toDate}','dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                                FROM Refundbilldetl,
                                                Refundbillmast,
                                                Billdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Refundbilldetl.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Bmc_Cnt = Billdetl.Bmc_Cnt
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND Refundbillmast.Rfc_Cacr IN ('O')
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=TO_DATE ('${fromDate}','dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=TO_DATE ('${toDate}','dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                                FROM Billmast,
                                                Refundbilldetl,
                                                Refundbillmast,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Billmast.Bmc_Slno = Refundbilldetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_code
                                                AND Prodescription.Pg_code = Progroup.Pg_code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Refundbillmast.Rfc_Cacr IN ('I')
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=TO_DATE ('${fromDate}','dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=TO_DATE ('${toDate}','dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO not IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (DSN_PACKAGEADJAMT, 0)) Amt,
                                                SUM (0) Taxamt
                                                FROM Disbillmast,
                                                Disbilldetl,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Disbillmast.dmc_Slno = Disbilldetl.dmc_Slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = Disbilldetl.pc_code
                                                AND Disbilldetl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 12
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >= TO_DATE ('${fromDate}','dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <= TO_DATE ('${toDate}','dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO not IN (${ipNumberList})
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc)
                                GROUP BY Code, Pcc_Desc
                                HAVING SUM (Amt) <> 0
                                ORDER BY Pcc_Desc`;
    try {
      const result = await conn_ora.execute(sql, {}, {outFormat: oracledb.OUT_FORMAT_OBJECT});
      callBack(err, result.rows);
    } catch (error) {
      console.log(error);
    } finally {
      if (conn_ora) await conn_ora.close();
    }
  },
  roomRentIncome: async (data, callBack) => {
    let conn_ora = await getTmcConnection();

    const ipNumberList = data.ptno.join(",");
    const fromDate = data.from;
    const toDate = data.to;

    const sql = `SELECT INITCAP (Pcc_Desc) Pcc_Desc,
                                        Code,
                                        SUM (Amt) Amt,
                                        SUM (Taxamt) Taxamt
                                FROM (  SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Svn_Qty * Svn_Rate, 0) - NVL (Svn_Disamt, 0)) Amt,
                                                SUM (NVL (PATSERVICE.SVN_TOTTAX, 0)) Taxamt
                                                FROM Patservice,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patservice.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patservice.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Procategory.Pc_Code = Progroup.Pc_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Svc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})                
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL ( (Vsn_Rate), 0) - NVL (Vsn_disamt, 0)) Amt,
                                                SUM (NVL (Patvisit.VSN_TOTTAX, 0)) Taxamt
                                                FROM Patvisit,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patvisit.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Vscode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Vsc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Rdn_Amount * Rdn_Days, 0) - NVL (Rdn_Disamt, 0)) Amt,
                                                SUM (NVL (Disrmrentdetl.RDN_TOTTAX, 0)) Taxamt
                                                FROM Disrmrentdetl,
                                                Disbillmast,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Disrmrentdetl.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Disrmrentdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                        NVL (disroomdetl.drn_nurdays, 0)
                                                        * NVL (disroomdetl.drn_nuramt, 0))
                                                        Amt,
                                                SUM (0) Taxamt
                                                FROM Procategory,
                                                ipparam,
                                                disbillmast,
                                                disroomdetl,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     disbillmast.dmc_slno = disroomdetl.dmc_slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND ipparam.ipc_nucode = Misincexpdtl.Pc_code
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_cancel, 'N') = 'N'
                                                AND NVL (disroomdetl.dmc_cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.DMD_DATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Iprefunditemdetl.Rin_Netamt, 0)) * -1 Amt,
                                                SUM (NVL (Iprefunditemdetl.RIN_TOTTAX, 0)) * -1 Taxamt
                                                FROM Misincexpgroup,
                                                Misincexpdtl,
                                                Iprefunditemdetl,
                                                Iprefundmast,
                                                Procategory
                                        WHERE     Iprefundmast.Ric_Slno = Iprefunditemdetl.Ric_Slno
                                                AND Iprefunditemdetl.Pc_Code = Procategory.Pc_Code
                                                AND Iprefunditemdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpgroup.Dg_Grcode = Misincexpdtl.Dg_Grcode
                                                AND Misincexpgroup.Dg_Type = 'R'
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND Iprefunditemdetl.Ric_Type <> 'PHY'
                                                AND Iprefundmast.Ric_Cacr IN ('C', 'R')
                                                AND NVL (Iprefundmast.Ric_Cancel, 'N') = 'N'
                                                AND Iprefundmast.Rid_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Iprefundmast.Rid_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND IPREFUNDMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                        NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                        Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                                FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND Misincexpdtl.Dg_grcode = 3
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                        NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                        Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                                FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_2Ndasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                                FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                        Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                                FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Cmn_Netamt, 0) - NVL (Cmn_Outcoll, 0)) Amt,
                                                SUM (0) Taxamt
                                                FROM Canbillmast,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Canbillmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Canteencode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Canbillmast.Cmc_Cancel, 'N') = 'N'
                                                AND Canbillmast.Cmc_Cacr = 'I'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                        NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                        Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                                FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Operation_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                        NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                        Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                                FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Theater_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Chief_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D1Stasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D2Ndasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_2Ndasst
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D3Rdasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Guest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                                FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest2_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                                FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurother.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                        Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                                FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                                FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Receiptmast.Rpc_Cancel, 'N') <> 'C'
                                                AND Receiptmast.RPC_COLLCNCODE IS NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.Rpd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.Rpd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                                FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND Receiptmast.RPC_COLLCNCODE IS NOT NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.RPD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.RPD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Receiptdetl.Rpn_Netamt) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                                FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Receiptmast.Rpc_Cacr = 'O'
                                                AND Opbillmast.Opc_cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                                FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Refundreceiptmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptdetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptdetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                                FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NOT NULL
                                                AND Refundreceiptmast.Rfc_Cancel IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptmast.RFD_RETDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptmast.RFD_RETDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                                FROM Refundreceiptdetl,
                                                refundreceiptmast,
                                                Receiptdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptdetl.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Refundreceiptdetl.Rpc_Cnt = Receiptdetl.Rpc_Cnt
                                                AND REFUNDRECEIPTMAST.Rfc_Slno = REFUNDRECEIPTDETL.Rfc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundreceiptdetl.Rfc_Cancel, 'N') = 'N'
                                                AND REFUNDRECEIPTMAST.RFC_CAcr IN ('O')
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                        (Billdetl.Pdn_Rate * Pdn_Qty)
                                                        - NVL (Billdetl.Bmn_Disamt, 0))
                                                        Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                                FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') <> 'C'
                                                AND billmast.BMC_COLLCNCODE IS NULL
                                                AND Billmast.Bmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.Bmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.IP_NO NOT IN (${ipNumberList})                
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                        (Billdetl.Pdn_Rate * Pdn_Qty)
                                                        - NVL (Billdetl.Bmn_Disamt, 0))
                                                        Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                                FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND billmast.BMC_COLLCNCODE IS NOT NULL
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND Billmast.BMD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.BMD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.IP_NO NOT IN (${ipNumberList})       
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                        (Billdetl.Pdn_Rate * Pdn_Qty)
                                                        - NVL (Billdetl.Bmn_Disamt, 0))
                                                        Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                                FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'O'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.IP_NO NOT IN (${ipNumberList})       
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                        (Billdetl.Pdn_Rate * Pdn_Qty)
                                                        - NVL (Billdetl.Bmn_Disamt, 0))
                                                        Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                                FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Disbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'I'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.IP_NO NOT IN (${ipNumberList})       
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                                FROM Refundbilldetl,
                                                Refundbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Billmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Refundbillmast.Bmc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Refundbillmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundbillmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundbilldetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundbilldetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.IP_NO NOT IN (${ipNumberList})       
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                                FROM Refundbilldetl,
                                                Refundbillmast,
                                                Billdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Refundbilldetl.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Bmc_Cnt = Billdetl.Bmc_Cnt
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND Refundbillmast.Rfc_Cacr IN ('O')
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                                FROM Billmast,
                                                Refundbilldetl,
                                                Refundbillmast,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Billmast.Bmc_Slno = Refundbilldetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_code
                                                AND Prodescription.Pg_code = Progroup.Pg_code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Refundbillmast.Rfc_Cacr IN ('I')
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.IP_NO NOT IN (${ipNumberList})       
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (DSN_PACKAGEADJAMT, 0)) Amt,
                                                SUM (0) Taxamt
                                                FROM Disbillmast,
                                                Disbilldetl,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Disbillmast.dmc_Slno = Disbilldetl.dmc_Slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = Disbilldetl.pc_code
                                                AND Disbilldetl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 3
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.IP_NO NOT IN (${ipNumberList})       
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc)
                                GROUP BY Code, Pcc_Desc
                                HAVING SUM (Amt) <> 0
                                ORDER BY Pcc_Desc`;

    try {
      const result = await conn_ora.execute(sql, {}, {outFormat: oracledb.OUT_FORMAT_OBJECT});
      callBack(err, result.rows);
    } catch (error) {
      console.log(error);
    } finally {
      if (conn_ora) await conn_ora.close();
    }
  },
  otherIncome: async (data, callBack) => {
    let conn_ora = await getTmcConnection();

    const ipNumberList = data.ptno.join(",");
    const fromDate = data.from;
    const toDate = data.to;

    const sql = `SELECT INITCAP (Pcc_Desc) Pcc_Desc,
                                        Code,
                                        SUM (Amt) Amt,
                                        SUM (Taxamt) Taxamt
                                FROM (  
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Svn_Qty * Svn_Rate, 0) - NVL (Svn_Disamt, 0)) Amt,
                                                SUM (NVL (PATSERVICE.SVN_TOTTAX, 0)) Taxamt
                                        FROM Patservice,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patservice.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patservice.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Procategory.Pc_Code = Progroup.Pc_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Svc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL ( (Vsn_Rate), 0) - NVL (Vsn_disamt, 0)) Amt,
                                                SUM (NVL (Patvisit.VSN_TOTTAX, 0)) Taxamt
                                        FROM Patvisit,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patvisit.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Vscode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Vsc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Rdn_Amount * Rdn_Days, 0) - NVL (Rdn_Disamt, 0)) Amt,
                                                SUM (NVL (Disrmrentdetl.RDN_TOTTAX, 0)) Taxamt
                                        FROM Disrmrentdetl,
                                                Disbillmast,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Disrmrentdetl.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Disrmrentdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (disroomdetl.drn_nurdays, 0)
                                                * NVL (disroomdetl.drn_nuramt, 0))
                                                Amt,
                                                SUM (0) Taxamt
                                        FROM Procategory,
                                                ipparam,
                                                disbillmast,
                                                disroomdetl,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     disbillmast.dmc_slno = disroomdetl.dmc_slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND ipparam.ipc_nucode = Misincexpdtl.Pc_code
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_cancel, 'N') = 'N'
                                                AND NVL (disroomdetl.dmc_cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.DMD_DATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Iprefunditemdetl.Rin_Netamt, 0)) * -1 Amt,
                                                SUM (NVL (Iprefunditemdetl.RIN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Misincexpgroup,
                                                Misincexpdtl,
                                                Iprefunditemdetl,
                                                Iprefundmast,
                                                Procategory
                                        WHERE     Iprefundmast.Ric_Slno = Iprefunditemdetl.Ric_Slno
                                                AND Iprefunditemdetl.Pc_Code = Procategory.Pc_Code
                                                AND Iprefunditemdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpgroup.Dg_Grcode = Misincexpdtl.Dg_Grcode
                                                AND Misincexpgroup.Dg_Type = 'R'
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND Iprefunditemdetl.Ric_Type <> 'PHY'
                                                AND Iprefundmast.Ric_Cacr IN ('C', 'R')
                                                AND NVL (Iprefundmast.Ric_Cancel, 'N') = 'N'
                                                AND Iprefundmast.Rid_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Iprefundmast.Rid_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND IPREFUNDMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND Misincexpdtl.Dg_grcode = 17
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0))) Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_2Ndasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Cmn_Netamt, 0) - NVL (Cmn_Outcoll, 0)) Amt,
                                                SUM (0) Taxamt
                                        FROM Canbillmast,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Canbillmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Canteencode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Canbillmast.Cmc_Cancel, 'N') = 'N'
                                                AND Canbillmast.Cmc_Cacr = 'I'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Operation_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Theater_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Chief_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D1Stasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D2Ndasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_2Ndasst
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D3Rdasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Guest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest2_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurother.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Receiptmast.Rpc_Cancel, 'N') <> 'C'
                                                AND Receiptmast.RPC_COLLCNCODE IS NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.Rpd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.Rpd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND Receiptmast.RPC_COLLCNCODE IS NOT NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.RPD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.RPD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Receiptdetl.Rpn_Netamt) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Receiptmast.Rpc_Cacr = 'O'
                                                AND Opbillmast.Opc_cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Refundreceiptmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptdetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptdetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NOT NULL
                                                AND Refundreceiptmast.Rfc_Cancel IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptmast.RFD_RETDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptmast.RFD_RETDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                refundreceiptmast,
                                                Receiptdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptdetl.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Refundreceiptdetl.Rpc_Cnt = Receiptdetl.Rpc_Cnt
                                                AND REFUNDRECEIPTMAST.Rfc_Slno = REFUNDRECEIPTDETL.Rfc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundreceiptdetl.Rfc_Cancel, 'N') = 'N'
                                                AND REFUNDRECEIPTMAST.RFC_CAcr IN ('O')
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') <> 'C'
                                                AND billmast.BMC_COLLCNCODE IS NULL
                                                AND Billmast.Bmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.Bmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND billmast.BMC_COLLCNCODE IS NOT NULL
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND Billmast.BMD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.BMD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'O'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Disbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'I'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                                Refundbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Billmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Refundbillmast.Bmc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Refundbillmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundbillmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundbilldetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundbilldetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                                Refundbillmast,
                                                Billdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Refundbilldetl.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Bmc_Cnt = Billdetl.Bmc_Cnt
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND Refundbillmast.Rfc_Cacr IN ('O')
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Billmast,
                                                Refundbilldetl,
                                                Refundbillmast,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Billmast.Bmc_Slno = Refundbilldetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_code
                                                AND Prodescription.Pg_code = Progroup.Pg_code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Refundbillmast.Rfc_Cacr IN ('I')
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >= TO_DATE ('${fromDate}', 'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <= TO_DATE ('${toDate}','dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (DSN_PACKAGEADJAMT, 0)) Amt,
                                                SUM (0) Taxamt
                                        FROM Disbillmast,
                                                Disbilldetl,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Disbillmast.dmc_Slno = Disbilldetl.dmc_Slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = Disbilldetl.pc_code
                                                AND Disbilldetl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 17
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.IP_NO NOT IN (${ipNumberList})                 
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc)
                                GROUP BY Code, Pcc_Desc
                                HAVING SUM (Amt) <> 0
                                ORDER BY Pcc_Desc`;

    try {
      const result = await conn_ora.execute(sql, {}, {outFormat: oracledb.OUT_FORMAT_OBJECT});
      callBack(err, result.rows);
    } catch (error) {
      console.log(error);
    } finally {
      if (conn_ora) await conn_ora.close();
    }
  },
  consultingIncome: async (data, callBack) => {
    let conn_ora = await getTmcConnection();

    const ipNumberList = data.ptno.join(",");
    const fromDate = data.from;
    const toDate = data.to;

    const sql = `SELECT INITCAP (Pcc_Desc) Pcc_Desc,
                                        Code,
                                        SUM (Amt) Amt,
                                        SUM (Taxamt) Taxamt
                                FROM (  SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Svn_Qty * Svn_Rate, 0) - NVL (Svn_Disamt, 0)) Amt,
                                                SUM (NVL (PATSERVICE.SVN_TOTTAX, 0)) Taxamt
                                        FROM Patservice,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patservice.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patservice.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Procategory.Pc_Code = Progroup.Pc_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Svc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL ( (Vsn_Rate), 0) - NVL (Vsn_disamt, 0)) Amt,
                                                SUM (NVL (Patvisit.VSN_TOTTAX, 0)) Taxamt
                                        FROM Patvisit,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patvisit.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Vscode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Vsc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Rdn_Amount * Rdn_Days, 0) - NVL (Rdn_Disamt, 0)) Amt,
                                                SUM (NVL (Disrmrentdetl.RDN_TOTTAX, 0)) Taxamt
                                        FROM Disrmrentdetl,
                                                Disbillmast,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Disrmrentdetl.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Disrmrentdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (disroomdetl.drn_nurdays, 0)
                                                * NVL (disroomdetl.drn_nuramt, 0))
                                                Amt,
                                                SUM (0) Taxamt
                                        FROM Procategory,
                                                ipparam,
                                                disbillmast,
                                                disroomdetl,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     disbillmast.dmc_slno = disroomdetl.dmc_slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND ipparam.ipc_nucode = Misincexpdtl.Pc_code
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_cancel, 'N') = 'N'
                                                AND NVL (disroomdetl.dmc_cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.DMD_DATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                        AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})   
                                        AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Iprefunditemdetl.Rin_Netamt, 0)) * -1 Amt,
                                                SUM (NVL (Iprefunditemdetl.RIN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Misincexpgroup,
                                                Misincexpdtl,
                                                Iprefunditemdetl,
                                                Iprefundmast,
                                                Procategory
                                        WHERE     Iprefundmast.Ric_Slno = Iprefunditemdetl.Ric_Slno
                                                AND Iprefunditemdetl.Pc_Code = Procategory.Pc_Code
                                                AND Iprefunditemdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpgroup.Dg_Grcode = Misincexpdtl.Dg_Grcode
                                                AND Misincexpgroup.Dg_Type = 'R'
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND Iprefunditemdetl.Ric_Type <> 'PHY'
                                                AND Iprefundmast.Ric_Cacr IN ('C', 'R')
                                                AND NVL (Iprefundmast.Ric_Cancel, 'N') = 'N'
                                                AND Iprefundmast.Rid_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Iprefundmast.Rid_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND IPREFUNDMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND Misincexpdtl.Dg_grcode = 5
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_2Ndasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Cmn_Netamt, 0) - NVL (Cmn_Outcoll, 0)) Amt,
                                                SUM (0) Taxamt
                                        FROM Canbillmast,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Canbillmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Canteencode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Canbillmast.Cmc_Cancel, 'N') = 'N'
                                                AND Canbillmast.Cmc_Cacr = 'I'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Operation_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Theater_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Chief_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D1Stasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D2Ndasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_2Ndasst
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D3Rdasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Guest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest2_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurother.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Receiptmast.Rpc_Cancel, 'N') <> 'C'
                                                AND Receiptmast.RPC_COLLCNCODE IS NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.Rpd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.Rpd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND Receiptmast.RPC_COLLCNCODE IS NOT NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.RPD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.RPD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Receiptdetl.Rpn_Netamt) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Receiptmast.Rpc_Cacr = 'O'
                                                AND Opbillmast.Opc_cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Refundreceiptmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptdetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptdetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NOT NULL
                                                AND Refundreceiptmast.Rfc_Cancel IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptmast.RFD_RETDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptmast.RFD_RETDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                refundreceiptmast,
                                                Receiptdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptdetl.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Refundreceiptdetl.Rpc_Cnt = Receiptdetl.Rpc_Cnt
                                                AND REFUNDRECEIPTMAST.Rfc_Slno = REFUNDRECEIPTDETL.Rfc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundreceiptdetl.Rfc_Cancel, 'N') = 'N'
                                                AND REFUNDRECEIPTMAST.RFC_CAcr IN ('O')
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') <> 'C'
                                                AND billmast.BMC_COLLCNCODE IS NULL
                                                AND Billmast.Bmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.Bmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND billmast.BMC_COLLCNCODE IS NOT NULL
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND Billmast.BMD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.BMD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'O'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Disbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'I'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                                Refundbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Billmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Refundbillmast.Bmc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Refundbillmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundbillmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundbilldetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundbilldetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                                Refundbillmast,
                                                Billdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Refundbilldetl.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Bmc_Cnt = Billdetl.Bmc_Cnt
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND Refundbillmast.Rfc_Cacr IN ('O')
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Billmast,
                                                Refundbilldetl,
                                                Refundbillmast,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Billmast.Bmc_Slno = Refundbilldetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_code
                                                AND Prodescription.Pg_code = Progroup.Pg_code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Refundbillmast.Rfc_Cacr IN ('I')
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (DSN_PACKAGEADJAMT, 0)) Amt,
                                                SUM (0) Taxamt
                                        FROM Disbillmast,
                                                Disbilldetl,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Disbillmast.dmc_Slno = Disbilldetl.dmc_Slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = Disbilldetl.pc_code
                                                AND Disbilldetl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 5
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.IP_NO NOT IN (${ipNumberList})
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc)
                                GROUP BY Code, Pcc_Desc
                                HAVING SUM (Amt) <> 0
                                ORDER BY Pcc_Desc`;
    try {
      const result = await conn_ora.execute(sql, {}, {outFormat: oracledb.OUT_FORMAT_OBJECT});
      callBack(err, result.rows);
    } catch (error) {
      console.log(error);
    } finally {
      if (conn_ora) await conn_ora.close();
    }
  },
  anesthetiaIncome: async (data, callBack) => {
    let conn_ora = await getTmcConnection();

    const ipNumberList = data.ptno.join(",");
    const fromDate = data.from;
    const toDate = data.to;

    const sql = `SELECT INITCAP (Pcc_Desc) Pcc_Desc,
                                        Code,
                                        SUM (Amt) Amt,
                                        SUM (Taxamt) Taxamt
                                FROM (  SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Svn_Qty * Svn_Rate, 0) - NVL (Svn_Disamt, 0)) Amt,
                                                SUM (NVL (PATSERVICE.SVN_TOTTAX, 0)) Taxamt
                                        FROM Patservice,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patservice.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patservice.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Procategory.Pc_Code = Progroup.Pc_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Svc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL ( (Vsn_Rate), 0) - NVL (Vsn_disamt, 0)) Amt,
                                                SUM (NVL (Patvisit.VSN_TOTTAX, 0)) Taxamt
                                        FROM Patvisit,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patvisit.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Vscode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Vsc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Rdn_Amount * Rdn_Days, 0) - NVL (Rdn_Disamt, 0)) Amt,
                                                SUM (NVL (Disrmrentdetl.RDN_TOTTAX, 0)) Taxamt
                                        FROM Disrmrentdetl,
                                                Disbillmast,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Disrmrentdetl.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Disrmrentdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (disroomdetl.drn_nurdays, 0)
                                                * NVL (disroomdetl.drn_nuramt, 0))
                                                Amt,
                                                SUM (0) Taxamt
                                        FROM Procategory,
                                                ipparam,
                                                disbillmast,
                                                disroomdetl,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     disbillmast.dmc_slno = disroomdetl.dmc_slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND ipparam.ipc_nucode = Misincexpdtl.Pc_code
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_cancel, 'N') = 'N'
                                                AND NVL (disroomdetl.dmc_cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.DMD_DATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Iprefunditemdetl.Rin_Netamt, 0)) * -1 Amt,
                                                SUM (NVL (Iprefunditemdetl.RIN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Misincexpgroup,
                                                Misincexpdtl,
                                                Iprefunditemdetl,
                                                Iprefundmast,
                                                Procategory
                                        WHERE     Iprefundmast.Ric_Slno = Iprefunditemdetl.Ric_Slno
                                                AND Iprefunditemdetl.Pc_Code = Procategory.Pc_Code
                                                AND Iprefunditemdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpgroup.Dg_Grcode = Misincexpdtl.Dg_Grcode
                                                AND Misincexpgroup.Dg_Type = 'R'
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND Iprefunditemdetl.Ric_Type <> 'PHY'
                                                AND Iprefundmast.Ric_Cacr IN ('C', 'R')
                                                AND NVL (Iprefundmast.Ric_Cancel, 'N') = 'N'
                                                AND Iprefundmast.Rid_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Iprefundmast.Rid_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND IPREFUNDMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND Misincexpdtl.Dg_grcode = 22
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_2Ndasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Cmn_Netamt, 0) - NVL (Cmn_Outcoll, 0)) Amt,
                                                SUM (0) Taxamt
                                        FROM Canbillmast,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Canbillmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Canteencode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Canbillmast.Cmc_Cancel, 'N') = 'N'
                                                AND Canbillmast.Cmc_Cacr = 'I'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Operation_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Theater_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Chief_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D1Stasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D2Ndasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_2Ndasst
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D3Rdasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Guest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest2_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurother.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Receiptmast.Rpc_Cancel, 'N') <> 'C'
                                                AND Receiptmast.RPC_COLLCNCODE IS NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.Rpd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.Rpd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND Receiptmast.RPC_COLLCNCODE IS NOT NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.RPD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.RPD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Receiptdetl.Rpn_Netamt) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Receiptmast.Rpc_Cacr = 'O'
                                                AND Opbillmast.Opc_cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Refundreceiptmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptdetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptdetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NOT NULL
                                                AND Refundreceiptmast.Rfc_Cancel IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptmast.RFD_RETDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptmast.RFD_RETDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                refundreceiptmast,
                                                Receiptdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptdetl.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Refundreceiptdetl.Rpc_Cnt = Receiptdetl.Rpc_Cnt
                                                AND REFUNDRECEIPTMAST.Rfc_Slno = REFUNDRECEIPTDETL.Rfc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundreceiptdetl.Rfc_Cancel, 'N') = 'N'
                                                AND REFUNDRECEIPTMAST.RFC_CAcr IN ('O')
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') <> 'C'
                                                AND billmast.BMC_COLLCNCODE IS NULL
                                                AND Billmast.Bmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.Bmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND billmast.BMC_COLLCNCODE IS NOT NULL
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND Billmast.BMD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.BMD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'O'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Disbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'I'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                                Refundbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Billmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Refundbillmast.Bmc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Refundbillmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundbillmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundbilldetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundbilldetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                                Refundbillmast,
                                                Billdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Refundbilldetl.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Bmc_Cnt = Billdetl.Bmc_Cnt
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND Refundbillmast.Rfc_Cacr IN ('O')
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Billmast,
                                                Refundbilldetl,
                                                Refundbillmast,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Billmast.Bmc_Slno = Refundbilldetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_code
                                                AND Prodescription.Pg_code = Progroup.Pg_code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Refundbillmast.Rfc_Cacr IN ('I')
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.IP_NO NOT IN (${ipNumberList})                
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (DSN_PACKAGEADJAMT, 0)) Amt,
                                                SUM (0) Taxamt
                                        FROM Disbillmast,
                                                Disbilldetl,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Disbillmast.dmc_Slno = Disbilldetl.dmc_Slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = Disbilldetl.pc_code
                                                AND Disbilldetl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 22
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                        AND Disbillmast.IP_NO NOT IN (${ipNumberList})
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc)
                                GROUP BY Code, Pcc_Desc
                                HAVING SUM (Amt) <> 0
                                ORDER BY Pcc_Desc`;
    try {
      const result = await conn_ora.execute(sql, {}, {outFormat: oracledb.OUT_FORMAT_OBJECT});
      callBack(err, result.rows);
    } catch (error) {
      console.log(error);
    } finally {
      if (conn_ora) await conn_ora.close();
    }
  },
  surgeonIncome: async (data, callBack) => {
    let conn_ora = await getTmcConnection();

    const ipNumberList = data.ptno.join(",");
    const fromDate = data.from;
    const toDate = data.to;

    const sql = `SELECT INITCAP (Pcc_Desc) Pcc_Desc,
                                        Code,
                                        SUM (Amt) Amt,
                                        SUM (Taxamt) Taxamt
                                FROM (  SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Svn_Qty * Svn_Rate, 0) - NVL (Svn_Disamt, 0)) Amt,
                                                SUM (NVL (PATSERVICE.SVN_TOTTAX, 0)) Taxamt
                                        FROM Patservice,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patservice.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patservice.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Procategory.Pc_Code = Progroup.Pc_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Svc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL ( (Vsn_Rate), 0) - NVL (Vsn_disamt, 0)) Amt,
                                                SUM (NVL (Patvisit.VSN_TOTTAX, 0)) Taxamt
                                        FROM Patvisit,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patvisit.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Vscode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Vsc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Rdn_Amount * Rdn_Days, 0) - NVL (Rdn_Disamt, 0)) Amt,
                                                SUM (NVL (Disrmrentdetl.RDN_TOTTAX, 0)) Taxamt
                                        FROM Disrmrentdetl,
                                                Disbillmast,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Disrmrentdetl.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Disrmrentdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (disroomdetl.drn_nurdays, 0)
                                                * NVL (disroomdetl.drn_nuramt, 0))
                                                Amt,
                                                SUM (0) Taxamt
                                        FROM Procategory,
                                                ipparam,
                                                disbillmast,
                                                disroomdetl,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     disbillmast.dmc_slno = disroomdetl.dmc_slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND ipparam.ipc_nucode = Misincexpdtl.Pc_code
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_cancel, 'N') = 'N'
                                                AND NVL (disroomdetl.dmc_cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.DMD_DATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Iprefunditemdetl.Rin_Netamt, 0)) * -1 Amt,
                                                SUM (NVL (Iprefunditemdetl.RIN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Misincexpgroup,
                                                Misincexpdtl,
                                                Iprefunditemdetl,
                                                Iprefundmast,
                                                Procategory
                                        WHERE     Iprefundmast.Ric_Slno = Iprefunditemdetl.Ric_Slno
                                                AND Iprefunditemdetl.Pc_Code = Procategory.Pc_Code
                                                AND Iprefunditemdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpgroup.Dg_Grcode = Misincexpdtl.Dg_Grcode
                                                AND Misincexpgroup.Dg_Type = 'R'
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND Iprefunditemdetl.Ric_Type <> 'PHY'
                                                AND Iprefundmast.Ric_Cacr IN ('C', 'R')
                                                AND NVL (Iprefundmast.Ric_Cancel, 'N') = 'N'
                                                AND Iprefundmast.Rid_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Iprefundmast.Rid_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND IPREFUNDMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND Misincexpdtl.Dg_grcode = 20
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_2Ndasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Cmn_Netamt, 0) - NVL (Cmn_Outcoll, 0)) Amt,
                                                SUM (0) Taxamt
                                        FROM Canbillmast,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Canbillmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Canteencode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Canbillmast.Cmc_Cancel, 'N') = 'N'
                                                AND Canbillmast.Cmc_Cacr = 'I'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Operation_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Theater_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Chief_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D1Stasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D2Ndasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_2Ndasst
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D3Rdasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Guest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest2_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurother.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Receiptmast.Rpc_Cancel, 'N') <> 'C'
                                                AND Receiptmast.RPC_COLLCNCODE IS NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.Rpd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.Rpd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND Receiptmast.RPC_COLLCNCODE IS NOT NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.RPD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.RPD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Receiptdetl.Rpn_Netamt) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Receiptmast.Rpc_Cacr = 'O'
                                                AND Opbillmast.Opc_cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Refundreceiptmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptdetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptdetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NOT NULL
                                                AND Refundreceiptmast.Rfc_Cancel IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptmast.RFD_RETDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptmast.RFD_RETDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                refundreceiptmast,
                                                Receiptdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptdetl.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Refundreceiptdetl.Rpc_Cnt = Receiptdetl.Rpc_Cnt
                                                AND REFUNDRECEIPTMAST.Rfc_Slno = REFUNDRECEIPTDETL.Rfc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundreceiptdetl.Rfc_Cancel, 'N') = 'N'
                                                AND REFUNDRECEIPTMAST.RFC_CAcr IN ('O')
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') <> 'C'
                                                AND billmast.BMC_COLLCNCODE IS NULL
                                                AND Billmast.Bmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.Bmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND billmast.BMC_COLLCNCODE IS NOT NULL
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND Billmast.BMD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.BMD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'O'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Disbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'I'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                                Refundbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Billmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Refundbillmast.Bmc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Refundbillmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundbillmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundbilldetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundbilldetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                                Refundbillmast,
                                                Billdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Refundbilldetl.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Bmc_Cnt = Billdetl.Bmc_Cnt
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND Refundbillmast.Rfc_Cacr IN ('O')
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Billmast,
                                                Refundbilldetl,
                                                Refundbillmast,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Billmast.Bmc_Slno = Refundbilldetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_code
                                                AND Prodescription.Pg_code = Progroup.Pg_code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Refundbillmast.Rfc_Cacr IN ('I')
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (DSN_PACKAGEADJAMT, 0)) Amt,
                                                SUM (0) Taxamt
                                        FROM Disbillmast,
                                                Disbilldetl,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Disbillmast.dmc_Slno = Disbilldetl.dmc_Slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = Disbilldetl.pc_code
                                                AND Disbilldetl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 20
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.IP_NO NOT IN (${ipNumberList})
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc)
                                GROUP BY Code, Pcc_Desc
                                HAVING SUM (Amt) <> 0
                                ORDER BY Pcc_Desc`;
    try {
      const result = await conn_ora.execute(sql, {}, {outFormat: oracledb.OUT_FORMAT_OBJECT});
      callBack(err, result.rows);
    } catch (error) {
      console.log(error);
    } finally {
      if (conn_ora) await conn_ora.close();
    }
  },
  theaterIncome: async (data, callBack) => {
    let conn_ora = await getTmcConnection();

    const ipNumberList = data.ptno.join(",");
    const fromDate = data.from;
    const toDate = data.to;

    const sql = `SELECT 
                                        INITCAP (Pcc_Desc) Pcc_Desc,
                                        Code,
                                        SUM (Amt) Amt,
                                        SUM (Taxamt) Taxamt
                                FROM (  SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Svn_Qty * Svn_Rate, 0) - NVL (Svn_Disamt, 0)) Amt,
                                                SUM (NVL (PATSERVICE.SVN_TOTTAX, 0)) Taxamt
                                        FROM Patservice,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patservice.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patservice.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Procategory.Pc_Code = Progroup.Pc_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Svc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL ( (Vsn_Rate), 0) - NVL (Vsn_disamt, 0)) Amt,
                                                SUM (NVL (Patvisit.VSN_TOTTAX, 0)) Taxamt
                                        FROM Patvisit,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patvisit.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Vscode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Vsc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Rdn_Amount * Rdn_Days, 0) - NVL (Rdn_Disamt, 0)) Amt,
                                                SUM (NVL (Disrmrentdetl.RDN_TOTTAX, 0)) Taxamt
                                        FROM Disrmrentdetl,
                                                Disbillmast,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Disrmrentdetl.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Disrmrentdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (disroomdetl.drn_nurdays, 0)
                                                * NVL (disroomdetl.drn_nuramt, 0))
                                                Amt,
                                                SUM (0) Taxamt
                                        FROM Procategory,
                                                ipparam,
                                                disbillmast,
                                                disroomdetl,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     disbillmast.dmc_slno = disroomdetl.dmc_slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND ipparam.ipc_nucode = Misincexpdtl.Pc_code
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_cancel, 'N') = 'N'
                                                AND NVL (disroomdetl.dmc_cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.DMD_DATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Iprefunditemdetl.Rin_Netamt, 0)) * -1 Amt,
                                                SUM (NVL (Iprefunditemdetl.RIN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Misincexpgroup,
                                                Misincexpdtl,
                                                Iprefunditemdetl,
                                                Iprefundmast,
                                                Procategory
                                        WHERE     Iprefundmast.Ric_Slno = Iprefunditemdetl.Ric_Slno
                                                AND Iprefunditemdetl.Pc_Code = Procategory.Pc_Code
                                                AND Iprefunditemdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpgroup.Dg_Grcode = Misincexpdtl.Dg_Grcode
                                                AND Misincexpgroup.Dg_Type = 'R'
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND Iprefunditemdetl.Ric_Type <> 'PHY'
                                                AND Iprefundmast.Ric_Cacr IN ('C', 'R')
                                                AND NVL (Iprefundmast.Ric_Cancel, 'N') = 'N'
                                                AND Iprefundmast.Rid_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Iprefundmast.Rid_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND IPREFUNDMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND Misincexpdtl.Dg_grcode = 19
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_2Ndasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Cmn_Netamt, 0) - NVL (Cmn_Outcoll, 0)) Amt,
                                                SUM (0) Taxamt
                                        FROM Canbillmast,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Canbillmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Canteencode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Canbillmast.Cmc_Cancel, 'N') = 'N'
                                                AND Canbillmast.Cmc_Cacr = 'I'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Operation_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Theater_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Chief_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D1Stasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D2Ndasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_2Ndasst
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D3Rdasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Guest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest2_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurother.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Receiptmast.Rpc_Cancel, 'N') <> 'C'
                                                AND Receiptmast.RPC_COLLCNCODE IS NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.Rpd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.Rpd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND Receiptmast.RPC_COLLCNCODE IS NOT NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.RPD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.RPD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Receiptdetl.Rpn_Netamt) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Receiptmast.Rpc_Cacr = 'O'
                                                AND Opbillmast.Opc_cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Refundreceiptmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptdetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptdetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NOT NULL
                                                AND Refundreceiptmast.Rfc_Cancel IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptmast.RFD_RETDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptmast.RFD_RETDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                refundreceiptmast,
                                                Receiptdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptdetl.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Refundreceiptdetl.Rpc_Cnt = Receiptdetl.Rpc_Cnt
                                                AND REFUNDRECEIPTMAST.Rfc_Slno = REFUNDRECEIPTDETL.Rfc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundreceiptdetl.Rfc_Cancel, 'N') = 'N'
                                                AND REFUNDRECEIPTMAST.RFC_CAcr IN ('O')
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') <> 'C'
                                                AND billmast.BMC_COLLCNCODE IS NULL
                                                AND Billmast.Bmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.Bmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND billmast.BMC_COLLCNCODE IS NOT NULL
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND Billmast.BMD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.BMD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'O'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Disbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'I'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                                Refundbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Billmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Refundbillmast.Bmc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Refundbillmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundbillmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundbilldetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundbilldetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                                Refundbillmast,
                                                Billdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Refundbilldetl.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Bmc_Cnt = Billdetl.Bmc_Cnt
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND Refundbillmast.Rfc_Cacr IN ('O')
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Billmast,
                                                Refundbilldetl,
                                                Refundbillmast,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Billmast.Bmc_Slno = Refundbilldetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_code
                                                AND Prodescription.Pg_code = Progroup.Pg_code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Refundbillmast.Rfc_Cacr IN ('I')
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (DSN_PACKAGEADJAMT, 0)) Amt,
                                                SUM (0) Taxamt
                                        FROM Disbillmast,
                                                Disbilldetl,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Disbillmast.dmc_Slno = Disbilldetl.dmc_Slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = Disbilldetl.pc_code
                                                AND Disbilldetl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 19
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.IP_NO NOT IN (${ipNumberList})
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc)
                                GROUP BY Code, Pcc_Desc
                                HAVING SUM (Amt) <> 0
                                ORDER BY Pcc_Desc`;

    try {
      const result = await conn_ora.execute(sql, {}, {outFormat: oracledb.OUT_FORMAT_OBJECT});
      callBack(err, result.rows);
    } catch (error) {
      console.log(error);
    } finally {
      if (conn_ora) await conn_ora.close();
    }
  },
  cardiologyIncome: async (data, callBack) => {
    let conn_ora = await getTmcConnection();

    const ipNumberList = data.ptno.join(",");
    const fromDate = data.from;
    const toDate = data.to;

    const sql = `SELECT INITCAP (Pcc_Desc) Pcc_Desc,
                                        Code,
                                        SUM (Amt) Amt,
                                        SUM (Taxamt) Taxamt
                                FROM (  SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Svn_Qty * Svn_Rate, 0) - NVL (Svn_Disamt, 0)) Amt,
                                                SUM (NVL (PATSERVICE.SVN_TOTTAX, 0)) Taxamt
                                        FROM Patservice,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patservice.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patservice.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Procategory.Pc_Code = Progroup.Pc_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Svc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL ( (Vsn_Rate), 0) - NVL (Vsn_disamt, 0)) Amt,
                                                SUM (NVL (Patvisit.VSN_TOTTAX, 0)) Taxamt
                                        FROM Patvisit,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patvisit.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Vscode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Vsc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Rdn_Amount * Rdn_Days, 0) - NVL (Rdn_Disamt, 0)) Amt,
                                                SUM (NVL (Disrmrentdetl.RDN_TOTTAX, 0)) Taxamt
                                        FROM Disrmrentdetl,
                                                Disbillmast,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Disrmrentdetl.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Disrmrentdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (disroomdetl.drn_nurdays, 0)
                                                * NVL (disroomdetl.drn_nuramt, 0))
                                                Amt,
                                                SUM (0) Taxamt
                                        FROM Procategory,
                                                ipparam,
                                                disbillmast,
                                                disroomdetl,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     disbillmast.dmc_slno = disroomdetl.dmc_slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND ipparam.ipc_nucode = Misincexpdtl.Pc_code
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_cancel, 'N') = 'N'
                                                AND NVL (disroomdetl.dmc_cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.DMD_DATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Iprefunditemdetl.Rin_Netamt, 0)) * -1 Amt,
                                                SUM (NVL (Iprefunditemdetl.RIN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Misincexpgroup,
                                                Misincexpdtl,
                                                Iprefunditemdetl,
                                                Iprefundmast,
                                                Procategory
                                        WHERE     Iprefundmast.Ric_Slno = Iprefunditemdetl.Ric_Slno
                                                AND Iprefunditemdetl.Pc_Code = Procategory.Pc_Code
                                                AND Iprefunditemdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpgroup.Dg_Grcode = Misincexpdtl.Dg_Grcode
                                                AND Misincexpgroup.Dg_Type = 'R'
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND Iprefunditemdetl.Ric_Type <> 'PHY'
                                                AND Iprefundmast.Ric_Cacr IN ('C', 'R')
                                                AND NVL (Iprefundmast.Ric_Cancel, 'N') = 'N'
                                                AND Iprefundmast.Rid_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Iprefundmast.Rid_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND IPREFUNDMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND Misincexpdtl.Dg_grcode = 4
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_2Ndasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Cmn_Netamt, 0) - NVL (Cmn_Outcoll, 0)) Amt,
                                                SUM (0) Taxamt
                                        FROM Canbillmast,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Canbillmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Canteencode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Canbillmast.Cmc_Cancel, 'N') = 'N'
                                                AND Canbillmast.Cmc_Cacr = 'I'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Operation_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Theater_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Chief_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D1Stasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D2Ndasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_2Ndasst
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D3Rdasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Guest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest2_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurother.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Receiptmast.Rpc_Cancel, 'N') <> 'C'
                                                AND Receiptmast.RPC_COLLCNCODE IS NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.Rpd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.Rpd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND Receiptmast.RPC_COLLCNCODE IS NOT NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.RPD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.RPD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Receiptdetl.Rpn_Netamt) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Receiptmast.Rpc_Cacr = 'O'
                                                AND Opbillmast.Opc_cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Refundreceiptmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptdetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptdetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NOT NULL
                                                AND Refundreceiptmast.Rfc_Cancel IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptmast.RFD_RETDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptmast.RFD_RETDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                refundreceiptmast,
                                                Receiptdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptdetl.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Refundreceiptdetl.Rpc_Cnt = Receiptdetl.Rpc_Cnt
                                                AND REFUNDRECEIPTMAST.Rfc_Slno = REFUNDRECEIPTDETL.Rfc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundreceiptdetl.Rfc_Cancel, 'N') = 'N'
                                                AND REFUNDRECEIPTMAST.RFC_CAcr IN ('O')
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') <> 'C'
                                                AND billmast.BMC_COLLCNCODE IS NULL
                                                AND Billmast.Bmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.Bmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND billmast.BMC_COLLCNCODE IS NOT NULL
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND Billmast.BMD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.BMD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'O'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Disbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'I'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                                Refundbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Billmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Refundbillmast.Bmc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Refundbillmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundbillmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundbilldetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundbilldetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                                Refundbillmast,
                                                Billdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Refundbilldetl.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Bmc_Cnt = Billdetl.Bmc_Cnt
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND Refundbillmast.Rfc_Cacr IN ('O')
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Billmast,
                                                Refundbilldetl,
                                                Refundbillmast,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Billmast.Bmc_Slno = Refundbilldetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_code
                                                AND Prodescription.Pg_code = Progroup.Pg_code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Refundbillmast.Rfc_Cacr IN ('I')
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (DSN_PACKAGEADJAMT, 0)) Amt,
                                                SUM (0) Taxamt
                                        FROM Disbillmast,
                                                Disbilldetl,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Disbillmast.dmc_Slno = Disbilldetl.dmc_Slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = Disbilldetl.pc_code
                                                AND Disbilldetl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 4
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                        AND Disbillmast.IP_NO NOT IN (${ipNumberList})
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc)
                                GROUP BY Code, Pcc_Desc
                                HAVING SUM (Amt) <> 0
                                ORDER BY Pcc_Desc`;

    try {
      const result = await conn_ora.execute(sql, {}, {outFormat: oracledb.OUT_FORMAT_OBJECT});
      callBack(err, result.rows);
    } catch (error) {
      console.log(error);
    } finally {
      if (conn_ora) await conn_ora.close();
    }
  },
  disPosibleItemIncome: async (data, callBack) => {
    let conn_ora = await getTmcConnection();

    // const ipNumberList = data.ptno.join(',');
    const ipNumberList = data.ptno.join(",");
    const fromDate = data.from;
    const toDate = data.to;

    const sql = `SELECT INITCAP (Pcc_Desc) Pcc_Desc,
                                        Code,
                                        SUM (Amt) Amt,
                                        SUM (Taxamt) Taxamt
                                FROM (  
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Svn_Qty * Svn_Rate, 0) - NVL (Svn_Disamt, 0)) Amt,
                                                SUM (NVL (PATSERVICE.SVN_TOTTAX, 0)) Taxamt
                                        FROM Patservice,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patservice.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patservice.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Procategory.Pc_Code = Progroup.Pc_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Svc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL ( (Vsn_Rate), 0) - NVL (Vsn_disamt, 0)) Amt,
                                                SUM (NVL (Patvisit.VSN_TOTTAX, 0)) Taxamt
                                        FROM Patvisit,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patvisit.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Vscode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Vsc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Rdn_Amount * Rdn_Days, 0) - NVL (Rdn_Disamt, 0)) Amt,
                                                SUM (NVL (Disrmrentdetl.RDN_TOTTAX, 0)) Taxamt
                                        FROM Disrmrentdetl,
                                                Disbillmast,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Disrmrentdetl.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Disrmrentdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (disroomdetl.drn_nurdays, 0)
                                                * NVL (disroomdetl.drn_nuramt, 0))
                                                Amt,
                                                SUM (0) Taxamt
                                        FROM Procategory,
                                                ipparam,
                                                disbillmast,
                                                disroomdetl,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     disbillmast.dmc_slno = disroomdetl.dmc_slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND ipparam.ipc_nucode = Misincexpdtl.Pc_code
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_cancel, 'N') = 'N'
                                                AND NVL (disroomdetl.dmc_cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.DMD_DATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Iprefunditemdetl.Rin_Netamt, 0)) * -1 Amt,
                                                SUM (NVL (Iprefunditemdetl.RIN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Misincexpgroup,
                                                Misincexpdtl,
                                                Iprefunditemdetl,
                                                Iprefundmast,
                                                Procategory
                                        WHERE     Iprefundmast.Ric_Slno = Iprefunditemdetl.Ric_Slno
                                                AND Iprefunditemdetl.Pc_Code = Procategory.Pc_Code
                                                AND Iprefunditemdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpgroup.Dg_Grcode = Misincexpdtl.Dg_Grcode
                                                AND Misincexpgroup.Dg_Type = 'R'
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND Iprefunditemdetl.Ric_Type <> 'PHY'
                                                AND Iprefundmast.Ric_Cacr IN ('C', 'R')
                                                AND NVL (Iprefundmast.Ric_Cancel, 'N') = 'N'
                                                AND Iprefundmast.Rid_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Iprefundmast.Rid_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND IPREFUNDMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND Misincexpdtl.Dg_grcode = 6
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_2Ndasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Cmn_Netamt, 0) - NVL (Cmn_Outcoll, 0)) Amt,
                                                SUM (0) Taxamt
                                        FROM Canbillmast,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Canbillmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Canteencode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Canbillmast.Cmc_Cancel, 'N') = 'N'
                                                AND Canbillmast.Cmc_Cacr = 'I'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Operation_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Theater_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Chief_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D1Stasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D2Ndasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_2Ndasst
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D3Rdasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Guest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest2_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurother.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Receiptmast.Rpc_Cancel, 'N') <> 'C'
                                                AND Receiptmast.RPC_COLLCNCODE IS NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.Rpd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.Rpd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND Receiptmast.RPC_COLLCNCODE IS NOT NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.RPD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.RPD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Receiptdetl.Rpn_Netamt) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Receiptmast.Rpc_Cacr = 'O'
                                                AND Opbillmast.Opc_cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Refundreceiptmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptdetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptdetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NOT NULL
                                                AND Refundreceiptmast.Rfc_Cancel IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptmast.RFD_RETDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptmast.RFD_RETDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                refundreceiptmast,
                                                Receiptdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptdetl.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Refundreceiptdetl.Rpc_Cnt = Receiptdetl.Rpc_Cnt
                                                AND REFUNDRECEIPTMAST.Rfc_Slno = REFUNDRECEIPTDETL.Rfc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundreceiptdetl.Rfc_Cancel, 'N') = 'N'
                                                AND REFUNDRECEIPTMAST.RFC_CAcr IN ('O')
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') <> 'C'
                                                AND billmast.BMC_COLLCNCODE IS NULL
                                                AND Billmast.Bmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.Bmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND billmast.BMC_COLLCNCODE IS NOT NULL
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND Billmast.BMD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.BMD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'O'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Disbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'I'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                                Refundbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Billmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Refundbillmast.Bmc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Refundbillmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundbillmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundbilldetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundbilldetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                                Refundbillmast,
                                                Billdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Refundbilldetl.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Bmc_Cnt = Billdetl.Bmc_Cnt
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND Refundbillmast.Rfc_Cacr IN ('O')
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Billmast,
                                                Refundbilldetl,
                                                Refundbillmast,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Billmast.Bmc_Slno = Refundbilldetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_code
                                                AND Prodescription.Pg_code = Progroup.Pg_code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Refundbillmast.Rfc_Cacr IN ('I')
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (DSN_PACKAGEADJAMT, 0)) Amt,
                                                SUM (0) Taxamt
                                        FROM Disbillmast,
                                                Disbilldetl,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Disbillmast.dmc_Slno = Disbilldetl.dmc_Slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = Disbilldetl.pc_code
                                                AND Disbilldetl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 6
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.IP_NO NOT IN (${ipNumberList})                
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc)
                                GROUP BY Code, Pcc_Desc
                                HAVING SUM (Amt) <> 0
                                ORDER BY Pcc_Desc`;

    try {
      const result = await conn_ora.execute(sql, {}, {outFormat: oracledb.OUT_FORMAT_OBJECT});
      callBack(err, result.rows);
    } catch (error) {
      console.log(error);
    } finally {
      if (conn_ora) await conn_ora.close();
    }
  },
  icuIncome: async (data, callBack) => {
    let conn_ora = await getTmcConnection();

    const ipNumberList = data.ptno.join(",");
    const fromDate = data.from;
    const toDate = data.to;

    const sql = `SELECT INITCAP (Pcc_Desc) Pcc_Desc,
                                        Code,
                                        SUM (Amt) Amt,
                                        SUM (Taxamt) Taxamt
                                FROM (  SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Svn_Qty * Svn_Rate, 0) - NVL (Svn_Disamt, 0)) Amt,
                                                SUM (NVL (PATSERVICE.SVN_TOTTAX, 0)) Taxamt
                                        FROM Patservice,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patservice.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patservice.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Procategory.Pc_Code = Progroup.Pc_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Svc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL ( (Vsn_Rate), 0) - NVL (Vsn_disamt, 0)) Amt,
                                                SUM (NVL (Patvisit.VSN_TOTTAX, 0)) Taxamt
                                        FROM Patvisit,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patvisit.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Vscode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Vsc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Rdn_Amount * Rdn_Days, 0) - NVL (Rdn_Disamt, 0)) Amt,
                                                SUM (NVL (Disrmrentdetl.RDN_TOTTAX, 0)) Taxamt
                                        FROM Disrmrentdetl,
                                                Disbillmast,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Disrmrentdetl.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Disrmrentdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (disroomdetl.drn_nurdays, 0)
                                                * NVL (disroomdetl.drn_nuramt, 0))
                                                Amt,
                                                SUM (0) Taxamt
                                        FROM Procategory,
                                                ipparam,
                                                disbillmast,
                                                disroomdetl,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     disbillmast.dmc_slno = disroomdetl.dmc_slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND ipparam.ipc_nucode = Misincexpdtl.Pc_code
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_cancel, 'N') = 'N'
                                                AND NVL (disroomdetl.dmc_cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.DMD_DATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Iprefunditemdetl.Rin_Netamt, 0)) * -1 Amt,
                                                SUM (NVL (Iprefunditemdetl.RIN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Misincexpgroup,
                                                Misincexpdtl,
                                                Iprefunditemdetl,
                                                Iprefundmast,
                                                Procategory
                                        WHERE     Iprefundmast.Ric_Slno = Iprefunditemdetl.Ric_Slno
                                                AND Iprefunditemdetl.Pc_Code = Procategory.Pc_Code
                                                AND Iprefunditemdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpgroup.Dg_Grcode = Misincexpdtl.Dg_Grcode
                                                AND Misincexpgroup.Dg_Type = 'R'
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND Iprefunditemdetl.Ric_Type <> 'PHY'
                                                AND Iprefundmast.Ric_Cacr IN ('C', 'R')
                                                AND NVL (Iprefundmast.Ric_Cancel, 'N') = 'N'
                                                AND Iprefundmast.Rid_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Iprefundmast.Rid_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND IPREFUNDMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND Misincexpdtl.Dg_grcode = 8
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_2Ndasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Cmn_Netamt, 0) - NVL (Cmn_Outcoll, 0)) Amt,
                                                SUM (0) Taxamt
                                        FROM Canbillmast,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Canbillmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Canteencode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Canbillmast.Cmc_Cancel, 'N') = 'N'
                                                AND Canbillmast.Cmc_Cacr = 'I'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Operation_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Theater_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Chief_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D1Stasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D2Ndasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_2Ndasst
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D3Rdasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Guest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest2_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurother.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Receiptmast.Rpc_Cancel, 'N') <> 'C'
                                                AND Receiptmast.RPC_COLLCNCODE IS NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.Rpd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.Rpd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND Receiptmast.RPC_COLLCNCODE IS NOT NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.RPD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.RPD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Receiptdetl.Rpn_Netamt) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Receiptmast.Rpc_Cacr = 'O'
                                                AND Opbillmast.Opc_cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Refundreceiptmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptdetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptdetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NOT NULL
                                                AND Refundreceiptmast.Rfc_Cancel IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptmast.RFD_RETDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptmast.RFD_RETDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                refundreceiptmast,
                                                Receiptdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptdetl.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Refundreceiptdetl.Rpc_Cnt = Receiptdetl.Rpc_Cnt
                                                AND REFUNDRECEIPTMAST.Rfc_Slno = REFUNDRECEIPTDETL.Rfc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundreceiptdetl.Rfc_Cancel, 'N') = 'N'
                                                AND REFUNDRECEIPTMAST.RFC_CAcr IN ('O')
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') <> 'C'
                                                AND billmast.BMC_COLLCNCODE IS NULL
                                                AND Billmast.Bmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.Bmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND billmast.BMC_COLLCNCODE IS NOT NULL
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND Billmast.BMD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.BMD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'O'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Disbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'I'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                                Refundbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Billmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Refundbillmast.Bmc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Refundbillmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundbillmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundbilldetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundbilldetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                                Refundbillmast,
                                                Billdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Refundbilldetl.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Bmc_Cnt = Billdetl.Bmc_Cnt
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND Refundbillmast.Rfc_Cacr IN ('O')
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Billmast,
                                                Refundbilldetl,
                                                Refundbillmast,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Billmast.Bmc_Slno = Refundbilldetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_code
                                                AND Prodescription.Pg_code = Progroup.Pg_code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Refundbillmast.Rfc_Cacr IN ('I')
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (DSN_PACKAGEADJAMT, 0)) Amt,
                                                SUM (0) Taxamt
                                        FROM Disbillmast,
                                                Disbilldetl,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Disbillmast.dmc_Slno = Disbilldetl.dmc_Slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = Disbilldetl.pc_code
                                                AND Disbilldetl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 8
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.IP_NO NOT IN (${ipNumberList})                                                        
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc)
                                GROUP BY Code, Pcc_Desc
                                HAVING SUM (Amt) <> 0
                                ORDER BY Pcc_Desc`;
    try {
      const result = await conn_ora.execute(sql, {}, {outFormat: oracledb.OUT_FORMAT_OBJECT});
      callBack(err, result.rows);
    } catch (error) {
      console.log(error);
    } finally {
      if (conn_ora) await conn_ora.close();
    }
  },
  icuprocedureIncome: async (data, callBack) => {
    let conn_ora = await getTmcConnection();

    const ipNumberList = data.ptno.join(",");
    const fromDate = data.from;
    const toDate = data.to;

    const sql = `SELECT INITCAP (Pcc_Desc) Pcc_Desc,
                                        Code,
                                        SUM (Amt) Amt,
                                        SUM (Taxamt) Taxamt
                                FROM (  
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Svn_Qty * Svn_Rate, 0) - NVL (Svn_Disamt, 0)) Amt,
                                                SUM (NVL (PATSERVICE.SVN_TOTTAX, 0)) Taxamt
                                        FROM Patservice,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patservice.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patservice.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Procategory.Pc_Code = Progroup.Pc_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Svc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL ( (Vsn_Rate), 0) - NVL (Vsn_disamt, 0)) Amt,
                                                SUM (NVL (Patvisit.VSN_TOTTAX, 0)) Taxamt
                                        FROM Patvisit,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patvisit.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Vscode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Vsc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Rdn_Amount * Rdn_Days, 0) - NVL (Rdn_Disamt, 0)) Amt,
                                                SUM (NVL (Disrmrentdetl.RDN_TOTTAX, 0)) Taxamt
                                        FROM Disrmrentdetl,
                                                Disbillmast,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Disrmrentdetl.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Disrmrentdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (disroomdetl.drn_nurdays, 0)
                                                * NVL (disroomdetl.drn_nuramt, 0))
                                                Amt,
                                                SUM (0) Taxamt
                                        FROM Procategory,
                                                ipparam,
                                                disbillmast,
                                                disroomdetl,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     disbillmast.dmc_slno = disroomdetl.dmc_slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND ipparam.ipc_nucode = Misincexpdtl.Pc_code
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_cancel, 'N') = 'N'
                                                AND NVL (disroomdetl.dmc_cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.DMD_DATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Iprefunditemdetl.Rin_Netamt, 0)) * -1 Amt,
                                                SUM (NVL (Iprefunditemdetl.RIN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Misincexpgroup,
                                                Misincexpdtl,
                                                Iprefunditemdetl,
                                                Iprefundmast,
                                                Procategory
                                        WHERE     Iprefundmast.Ric_Slno = Iprefunditemdetl.Ric_Slno
                                                AND Iprefunditemdetl.Pc_Code = Procategory.Pc_Code
                                                AND Iprefunditemdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpgroup.Dg_Grcode = Misincexpdtl.Dg_Grcode
                                                AND Misincexpgroup.Dg_Type = 'R'
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND Iprefunditemdetl.Ric_Type <> 'PHY'
                                                AND Iprefundmast.Ric_Cacr IN ('C', 'R')
                                                AND NVL (Iprefundmast.Ric_Cancel, 'N') = 'N'
                                                AND Iprefundmast.Rid_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Iprefundmast.Rid_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND IPREFUNDMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND Misincexpdtl.Dg_grcode = 9
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_2Ndasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Cmn_Netamt, 0) - NVL (Cmn_Outcoll, 0)) Amt,
                                                SUM (0) Taxamt
                                        FROM Canbillmast,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Canbillmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Canteencode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Canbillmast.Cmc_Cancel, 'N') = 'N'
                                                AND Canbillmast.Cmc_Cacr = 'I'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Operation_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Theater_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Chief_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D1Stasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D2Ndasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_2Ndasst
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D3Rdasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Guest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest2_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurother.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Receiptmast.Rpc_Cancel, 'N') <> 'C'
                                                AND Receiptmast.RPC_COLLCNCODE IS NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.Rpd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.Rpd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND Receiptmast.RPC_COLLCNCODE IS NOT NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.RPD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.RPD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Receiptdetl.Rpn_Netamt) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Receiptmast.Rpc_Cacr = 'O'
                                                AND Opbillmast.Opc_cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Refundreceiptmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptdetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptdetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NOT NULL
                                                AND Refundreceiptmast.Rfc_Cancel IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptmast.RFD_RETDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptmast.RFD_RETDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                refundreceiptmast,
                                                Receiptdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptdetl.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Refundreceiptdetl.Rpc_Cnt = Receiptdetl.Rpc_Cnt
                                                AND REFUNDRECEIPTMAST.Rfc_Slno = REFUNDRECEIPTDETL.Rfc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundreceiptdetl.Rfc_Cancel, 'N') = 'N'
                                                AND REFUNDRECEIPTMAST.RFC_CAcr IN ('O')
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') <> 'C'
                                                AND billmast.BMC_COLLCNCODE IS NULL
                                                AND Billmast.Bmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.Bmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND billmast.BMC_COLLCNCODE IS NOT NULL
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND Billmast.BMD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.BMD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'O'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Disbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'I'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                                Refundbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Billmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Refundbillmast.Bmc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Refundbillmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundbillmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundbilldetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundbilldetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                                Refundbillmast,
                                                Billdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Refundbilldetl.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Bmc_Cnt = Billdetl.Bmc_Cnt
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND Refundbillmast.Rfc_Cacr IN ('O')
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Billmast,
                                                Refundbilldetl,
                                                Refundbillmast,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Billmast.Bmc_Slno = Refundbilldetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_code
                                                AND Prodescription.Pg_code = Progroup.Pg_code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Refundbillmast.Rfc_Cacr IN ('I')
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (DSN_PACKAGEADJAMT, 0)) Amt,
                                                SUM (0) Taxamt
                                        FROM Disbillmast,
                                                Disbilldetl,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Disbillmast.dmc_Slno = Disbilldetl.dmc_Slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = Disbilldetl.pc_code
                                                AND Disbilldetl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 9
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                                AND Disbillmast.IP_NO NOT IN (${ipNumberList})
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc)
                                GROUP BY Code, Pcc_Desc
                                HAVING SUM (Amt) <> 0
                                ORDER BY Pcc_Desc`;
    try {
      const result = await conn_ora.execute(sql, {}, {outFormat: oracledb.OUT_FORMAT_OBJECT});
      callBack(err, result.rows);
    } catch (error) {
      console.log(error);
    } finally {
      if (conn_ora) await conn_ora.close();
    }
  },
  radiologyIncome: async (data, callBack) => {
    let conn_ora = await getTmcConnection();

    const ipNumberList = data.ptno.join(",");
    const fromDate = data.from;
    const toDate = data.to;

    const sql = `SELECT INITCAP (Pcc_Desc) Pcc_Desc,
                                        Code,
                                        SUM (Amt) Amt,
                                        SUM (Taxamt) Taxamt
                                FROM (  SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Svn_Qty * Svn_Rate, 0) - NVL (Svn_Disamt, 0)) Amt,
                                                SUM (NVL (PATSERVICE.SVN_TOTTAX, 0)) Taxamt
                                        FROM Patservice,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patservice.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patservice.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Procategory.Pc_Code = Progroup.Pc_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Svc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL ( (Vsn_Rate), 0) - NVL (Vsn_disamt, 0)) Amt,
                                                SUM (NVL (Patvisit.VSN_TOTTAX, 0)) Taxamt
                                        FROM Patvisit,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patvisit.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Vscode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Vsc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Rdn_Amount * Rdn_Days, 0) - NVL (Rdn_Disamt, 0)) Amt,
                                                SUM (NVL (Disrmrentdetl.RDN_TOTTAX, 0)) Taxamt
                                        FROM Disrmrentdetl,
                                                Disbillmast,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Disrmrentdetl.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Disrmrentdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (disroomdetl.drn_nurdays, 0)
                                                * NVL (disroomdetl.drn_nuramt, 0))
                                                Amt,
                                                SUM (0) Taxamt
                                        FROM Procategory,
                                                ipparam,
                                                disbillmast,
                                                disroomdetl,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     disbillmast.dmc_slno = disroomdetl.dmc_slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND ipparam.ipc_nucode = Misincexpdtl.Pc_code
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_cancel, 'N') = 'N'
                                                AND NVL (disroomdetl.dmc_cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.DMD_DATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Iprefunditemdetl.Rin_Netamt, 0)) * -1 Amt,
                                                SUM (NVL (Iprefunditemdetl.RIN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Misincexpgroup,
                                                Misincexpdtl,
                                                Iprefunditemdetl,
                                                Iprefundmast,
                                                Procategory
                                        WHERE     Iprefundmast.Ric_Slno = Iprefunditemdetl.Ric_Slno
                                                AND Iprefunditemdetl.Pc_Code = Procategory.Pc_Code
                                                AND Iprefunditemdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpgroup.Dg_Grcode = Misincexpdtl.Dg_Grcode
                                                AND Misincexpgroup.Dg_Type = 'R'
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND Iprefunditemdetl.Ric_Type <> 'PHY'
                                                AND Iprefundmast.Ric_Cacr IN ('C', 'R')
                                                AND NVL (Iprefundmast.Ric_Cancel, 'N') = 'N'
                                                AND Iprefundmast.Rid_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Iprefundmast.Rid_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND IPREFUNDMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND Misincexpdtl.Dg_grcode = 7
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_2Ndasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Cmn_Netamt, 0) - NVL (Cmn_Outcoll, 0)) Amt,
                                                SUM (0) Taxamt
                                        FROM Canbillmast,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Canbillmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Canteencode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Canbillmast.Cmc_Cancel, 'N') = 'N'
                                                AND Canbillmast.Cmc_Cacr = 'I'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Operation_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Theater_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Chief_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D1Stasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D2Ndasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_2Ndasst
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D3Rdasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Guest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest2_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurother.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Receiptmast.Rpc_Cancel, 'N') <> 'C'
                                                AND Receiptmast.RPC_COLLCNCODE IS NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.Rpd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.Rpd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND Receiptmast.RPC_COLLCNCODE IS NOT NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.RPD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.RPD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Receiptdetl.Rpn_Netamt) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Receiptmast.Rpc_Cacr = 'O'
                                                AND Opbillmast.Opc_cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Refundreceiptmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptdetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptdetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NOT NULL
                                                AND Refundreceiptmast.Rfc_Cancel IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptmast.RFD_RETDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptmast.RFD_RETDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                refundreceiptmast,
                                                Receiptdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptdetl.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Refundreceiptdetl.Rpc_Cnt = Receiptdetl.Rpc_Cnt
                                                AND REFUNDRECEIPTMAST.Rfc_Slno = REFUNDRECEIPTDETL.Rfc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundreceiptdetl.Rfc_Cancel, 'N') = 'N'
                                                AND REFUNDRECEIPTMAST.RFC_CAcr IN ('O')
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') <> 'C'
                                                AND billmast.BMC_COLLCNCODE IS NULL
                                                AND Billmast.Bmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.Bmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND billmast.BMC_COLLCNCODE IS NOT NULL
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND Billmast.BMD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.BMD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'O'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Disbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'I'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                                Refundbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Billmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Refundbillmast.Bmc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Refundbillmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundbillmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundbilldetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundbilldetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                                Refundbillmast,
                                                Billdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Refundbilldetl.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Bmc_Cnt = Billdetl.Bmc_Cnt
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND Refundbillmast.Rfc_Cacr IN ('O')
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Billmast,
                                                Refundbilldetl,
                                                Refundbillmast,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Billmast.Bmc_Slno = Refundbilldetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_code
                                                AND Prodescription.Pg_code = Progroup.Pg_code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Refundbillmast.Rfc_Cacr IN ('I')
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (DSN_PACKAGEADJAMT, 0)) Amt,
                                                SUM (0) Taxamt
                                        FROM Disbillmast,
                                                Disbilldetl,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Disbillmast.dmc_Slno = Disbilldetl.dmc_Slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = Disbilldetl.pc_code
                                                AND Disbilldetl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 7
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                                AND Disbillmast.IP_NO NOT IN (${ipNumberList})
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc)
                                GROUP BY Code, Pcc_Desc
                                HAVING SUM (Amt) <> 0
                                ORDER BY Pcc_Desc`;
    try {
      const result = await conn_ora.execute(sql, {}, {outFormat: oracledb.OUT_FORMAT_OBJECT});
      callBack(err, result.rows);
    } catch (error) {
      console.log(error);
    } finally {
      if (conn_ora) await conn_ora.close();
    }
  },
  laboratoryIncome: async (data, callBack) => {
    let conn_ora = await getTmcConnection();

    const ipNumberList = data.ptno.join(",");
    const fromDate = data.from;
    const toDate = data.to;

    const sql = `SELECT INITCAP (Pcc_Desc) Pcc_Desc,
                                        Code,
                                        SUM (Amt) Amt,
                                        SUM (Taxamt) Taxamt
                                FROM (  SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Svn_Qty * Svn_Rate, 0) - NVL (Svn_Disamt, 0)) Amt,
                                                SUM (NVL (PATSERVICE.SVN_TOTTAX, 0)) Taxamt
                                        FROM Patservice,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patservice.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patservice.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Procategory.Pc_Code = Progroup.Pc_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Svc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL ( (Vsn_Rate), 0) - NVL (Vsn_disamt, 0)) Amt,
                                                SUM (NVL (Patvisit.VSN_TOTTAX, 0)) Taxamt
                                        FROM Patvisit,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patvisit.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Vscode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Vsc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Rdn_Amount * Rdn_Days, 0) - NVL (Rdn_Disamt, 0)) Amt,
                                                SUM (NVL (Disrmrentdetl.RDN_TOTTAX, 0)) Taxamt
                                        FROM Disrmrentdetl,
                                                Disbillmast,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Disrmrentdetl.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Disrmrentdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (disroomdetl.drn_nurdays, 0)
                                                * NVL (disroomdetl.drn_nuramt, 0))
                                                Amt,
                                                SUM (0) Taxamt
                                        FROM Procategory,
                                                ipparam,
                                                disbillmast,
                                                disroomdetl,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     disbillmast.dmc_slno = disroomdetl.dmc_slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND ipparam.ipc_nucode = Misincexpdtl.Pc_code
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_cancel, 'N') = 'N'
                                                AND NVL (disroomdetl.dmc_cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.DMD_DATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Iprefunditemdetl.Rin_Netamt, 0)) * -1 Amt,
                                                SUM (NVL (Iprefunditemdetl.RIN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Misincexpgroup,
                                                Misincexpdtl,
                                                Iprefunditemdetl,
                                                Iprefundmast,
                                                Procategory
                                        WHERE     Iprefundmast.Ric_Slno = Iprefunditemdetl.Ric_Slno
                                                AND Iprefunditemdetl.Pc_Code = Procategory.Pc_Code
                                                AND Iprefunditemdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpgroup.Dg_Grcode = Misincexpdtl.Dg_Grcode
                                                AND Misincexpgroup.Dg_Type = 'R'
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND Iprefunditemdetl.Ric_Type <> 'PHY'
                                                AND Iprefundmast.Ric_Cacr IN ('C', 'R')
                                                AND NVL (Iprefundmast.Ric_Cancel, 'N') = 'N'
                                                AND Iprefundmast.Rid_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Iprefundmast.Rid_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND IPREFUNDMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND Misincexpdtl.Dg_grcode = 1
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_2Ndasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Cmn_Netamt, 0) - NVL (Cmn_Outcoll, 0)) Amt,
                                                SUM (0) Taxamt
                                        FROM Canbillmast,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Canbillmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Canteencode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Canbillmast.Cmc_Cancel, 'N') = 'N'
                                                AND Canbillmast.Cmc_Cacr = 'I'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Operation_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Theater_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Chief_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D1Stasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D2Ndasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_2Ndasst
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D3Rdasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Guest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest2_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurother.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Receiptmast.Rpc_Cancel, 'N') <> 'C'
                                                AND Receiptmast.RPC_COLLCNCODE IS NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.Rpd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.Rpd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND Receiptmast.RPC_COLLCNCODE IS NOT NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.RPD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.RPD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Receiptdetl.Rpn_Netamt) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Receiptmast.Rpc_Cacr = 'O'
                                                AND Opbillmast.Opc_cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Refundreceiptmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptdetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptdetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NOT NULL
                                                AND Refundreceiptmast.Rfc_Cancel IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptmast.RFD_RETDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptmast.RFD_RETDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                refundreceiptmast,
                                                Receiptdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptdetl.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Refundreceiptdetl.Rpc_Cnt = Receiptdetl.Rpc_Cnt
                                                AND REFUNDRECEIPTMAST.Rfc_Slno = REFUNDRECEIPTDETL.Rfc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundreceiptdetl.Rfc_Cancel, 'N') = 'N'
                                                AND REFUNDRECEIPTMAST.RFC_CAcr IN ('O')
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') <> 'C'
                                                AND billmast.BMC_COLLCNCODE IS NULL
                                                AND Billmast.Bmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.Bmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND billmast.BMC_COLLCNCODE IS NOT NULL
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND Billmast.BMD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.BMD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'O'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Disbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'I'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                                Refundbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Billmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Refundbillmast.Bmc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Refundbillmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundbillmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundbilldetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundbilldetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                                Refundbillmast,
                                                Billdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Refundbilldetl.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Bmc_Cnt = Billdetl.Bmc_Cnt
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND Refundbillmast.Rfc_Cacr IN ('O')
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Billmast,
                                                Refundbilldetl,
                                                Refundbillmast,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Billmast.Bmc_Slno = Refundbilldetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_code
                                                AND Prodescription.Pg_code = Progroup.Pg_code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Refundbillmast.Rfc_Cacr IN ('I')
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (DSN_PACKAGEADJAMT, 0)) Amt,
                                                SUM (0) Taxamt
                                        FROM Disbillmast,
                                                Disbilldetl,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Disbillmast.dmc_Slno = Disbilldetl.dmc_Slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = Disbilldetl.pc_code
                                                AND Disbilldetl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 1
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                        AND Disbillmast.IP_NO NOT IN (${ipNumberList})                 
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc)
                                GROUP BY Code, Pcc_Desc
                                HAVING SUM (Amt) <> 0
                                ORDER BY Pcc_Desc`;
    try {
      const result = await conn_ora.execute(sql, {}, {outFormat: oracledb.OUT_FORMAT_OBJECT});
      callBack(err, result.rows);
    } catch (error) {
      console.log(error);
    } finally {
      if (conn_ora) await conn_ora.close();
    }
  },
  mriIncome: async (data, callBack) => {
    let conn_ora = await getTmcConnection();

    const ipNumberList = data.ptno.join(",");
    const fromDate = data.from;
    const toDate = data.to;

    const sql = `SELECT INITCAP (Pcc_Desc) Pcc_Desc,
                                        Code,
                                        SUM (Amt) Amt,
                                        SUM (Taxamt) Taxamt
                                FROM (  SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Svn_Qty * Svn_Rate, 0) - NVL (Svn_Disamt, 0)) Amt,
                                                SUM (NVL (PATSERVICE.SVN_TOTTAX, 0)) Taxamt
                                        FROM Patservice,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patservice.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patservice.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Procategory.Pc_Code = Progroup.Pc_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Svc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL ( (Vsn_Rate), 0) - NVL (Vsn_disamt, 0)) Amt,
                                                SUM (NVL (Patvisit.VSN_TOTTAX, 0)) Taxamt
                                        FROM Patvisit,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patvisit.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Vscode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Vsc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Rdn_Amount * Rdn_Days, 0) - NVL (Rdn_Disamt, 0)) Amt,
                                                SUM (NVL (Disrmrentdetl.RDN_TOTTAX, 0)) Taxamt
                                        FROM Disrmrentdetl,
                                                Disbillmast,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Disrmrentdetl.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Disrmrentdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (disroomdetl.drn_nurdays, 0)
                                                * NVL (disroomdetl.drn_nuramt, 0))
                                                Amt,
                                                SUM (0) Taxamt
                                        FROM Procategory,
                                                ipparam,
                                                disbillmast,
                                                disroomdetl,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     disbillmast.dmc_slno = disroomdetl.dmc_slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND ipparam.ipc_nucode = Misincexpdtl.Pc_code
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_cancel, 'N') = 'N'
                                                AND NVL (disroomdetl.dmc_cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.DMD_DATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Iprefunditemdetl.Rin_Netamt, 0)) * -1 Amt,
                                                SUM (NVL (Iprefunditemdetl.RIN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Misincexpgroup,
                                                Misincexpdtl,
                                                Iprefunditemdetl,
                                                Iprefundmast,
                                                Procategory
                                        WHERE     Iprefundmast.Ric_Slno = Iprefunditemdetl.Ric_Slno
                                                AND Iprefunditemdetl.Pc_Code = Procategory.Pc_Code
                                                AND Iprefunditemdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpgroup.Dg_Grcode = Misincexpdtl.Dg_Grcode
                                                AND Misincexpgroup.Dg_Type = 'R'
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND Iprefunditemdetl.Ric_Type <> 'PHY'
                                                AND Iprefundmast.Ric_Cacr IN ('C', 'R')
                                                AND NVL (Iprefundmast.Ric_Cancel, 'N') = 'N'
                                                AND Iprefundmast.Rid_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Iprefundmast.Rid_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND IPREFUNDMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND Misincexpdtl.Dg_grcode = 44
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_2Ndasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                        AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})   
                                        AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})   
                                        AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})   
                                        AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Cmn_Netamt, 0) - NVL (Cmn_Outcoll, 0)) Amt,
                                                SUM (0) Taxamt
                                        FROM Canbillmast,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Canbillmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Canteencode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Canbillmast.Cmc_Cancel, 'N') = 'N'
                                                AND Canbillmast.Cmc_Cacr = 'I'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Operation_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Theater_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                        AND Patsurgery.IP_NO NOT IN (${ipNumberList})   
                                        AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Chief_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                        AND Patsurgery.IP_NO NOT IN (${ipNumberList})  
                                        AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D1Stasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                        AND Patsurgery.IP_NO NOT IN (${ipNumberList})   
                                        AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D2Ndasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_2Ndasst
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D3Rdasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Guest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                        AND Patsurgery.IP_NO NOT IN (${ipNumberList})  
                                        AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest2_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurother.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                        AND Patsurgery.IP_NO NOT IN (${ipNumberList})   
                                        AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Receiptmast.Rpc_Cancel, 'N') <> 'C'
                                                AND Receiptmast.RPC_COLLCNCODE IS NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.Rpd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.Rpd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND Receiptmast.RPC_COLLCNCODE IS NOT NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.RPD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.RPD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Receiptdetl.Rpn_Netamt) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Receiptmast.Rpc_Cacr = 'O'
                                                AND Opbillmast.Opc_cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Refundreceiptmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptdetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptdetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NOT NULL
                                                AND Refundreceiptmast.Rfc_Cancel IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptmast.RFD_RETDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptmast.RFD_RETDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                refundreceiptmast,
                                                Receiptdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptdetl.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Refundreceiptdetl.Rpc_Cnt = Receiptdetl.Rpc_Cnt
                                                AND REFUNDRECEIPTMAST.Rfc_Slno = REFUNDRECEIPTDETL.Rfc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundreceiptdetl.Rfc_Cancel, 'N') = 'N'
                                                AND REFUNDRECEIPTMAST.RFC_CAcr IN ('O')
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') <> 'C'
                                                AND billmast.BMC_COLLCNCODE IS NULL
                                                AND Billmast.Bmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.Bmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                        AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND billmast.BMC_COLLCNCODE IS NOT NULL
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND Billmast.BMD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.BMD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'O'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Disbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'I'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                                Refundbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Billmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Refundbillmast.Bmc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Refundbillmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundbillmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundbilldetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundbilldetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                                Refundbillmast,
                                                Billdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Refundbilldetl.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Bmc_Cnt = Billdetl.Bmc_Cnt
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND Refundbillmast.Rfc_Cacr IN ('O')
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Billmast,
                                                Refundbilldetl,
                                                Refundbillmast,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Billmast.Bmc_Slno = Refundbilldetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_code
                                                AND Prodescription.Pg_code = Progroup.Pg_code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Refundbillmast.Rfc_Cacr IN ('I')
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                        AND Billmast.IP_NO NOT IN (${ipNumberList})   
                                        AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (DSN_PACKAGEADJAMT, 0)) Amt,
                                                SUM (0) Taxamt
                                        FROM Disbillmast,
                                                Disbilldetl,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Disbillmast.dmc_Slno = Disbilldetl.dmc_Slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = Disbilldetl.pc_code
                                                AND Disbilldetl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 44
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                        AND Disbillmast.IP_NO NOT IN (${ipNumberList})
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        )
                                GROUP BY Code, Pcc_Desc
                                HAVING SUM (Amt) <> 0
                                ORDER BY Pcc_Desc`;
    try {
      const result = await conn_ora.execute(sql, {}, {outFormat: oracledb.OUT_FORMAT_OBJECT});
      callBack(err, result.rows);
    } catch (error) {
      console.log(error);
    } finally {
      if (conn_ora) await conn_ora.close();
    }
  },
  dietIncome: async (data, callBack) => {
    let conn_ora = await getTmcConnection();

    const ipNumberList = data.ptno.join(",");
    const fromDate = data.from;
    const toDate = data.to;

    const sql = `SELECT INITCAP (Pcc_Desc) Pcc_Desc,
                                        Code,
                                        SUM (Amt) Amt,
                                        SUM (Taxamt) Taxamt
                                FROM (  
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Svn_Qty * Svn_Rate, 0) - NVL (Svn_Disamt, 0)) Amt,
                                                SUM (NVL (PATSERVICE.SVN_TOTTAX, 0)) Taxamt
                                        FROM Patservice,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patservice.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patservice.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Procategory.Pc_Code = Progroup.Pc_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Svc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})                
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL ( (Vsn_Rate), 0) - NVL (Vsn_disamt, 0)) Amt,
                                                SUM (NVL (Patvisit.VSN_TOTTAX, 0)) Taxamt
                                        FROM Patvisit,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patvisit.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Vscode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Vsc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Rdn_Amount * Rdn_Days, 0) - NVL (Rdn_Disamt, 0)) Amt,
                                                SUM (NVL (Disrmrentdetl.RDN_TOTTAX, 0)) Taxamt
                                        FROM Disrmrentdetl,
                                                Disbillmast,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Disrmrentdetl.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Disrmrentdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (disroomdetl.drn_nurdays, 0)
                                                * NVL (disroomdetl.drn_nuramt, 0))
                                                Amt,
                                                SUM (0) Taxamt
                                        FROM Procategory,
                                                ipparam,
                                                disbillmast,
                                                disroomdetl,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     disbillmast.dmc_slno = disroomdetl.dmc_slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND ipparam.ipc_nucode = Misincexpdtl.Pc_code
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_cancel, 'N') = 'N'
                                                AND NVL (disroomdetl.dmc_cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.DMD_DATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Iprefunditemdetl.Rin_Netamt, 0)) * -1 Amt,
                                                SUM (NVL (Iprefunditemdetl.RIN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Misincexpgroup,
                                                Misincexpdtl,
                                                Iprefunditemdetl,
                                                Iprefundmast,
                                                Procategory
                                        WHERE     Iprefundmast.Ric_Slno = Iprefunditemdetl.Ric_Slno
                                                AND Iprefunditemdetl.Pc_Code = Procategory.Pc_Code
                                                AND Iprefunditemdetl.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpgroup.Dg_Grcode = Misincexpdtl.Dg_Grcode
                                                AND Misincexpgroup.Dg_Type = 'R'
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND Iprefunditemdetl.Ric_Type <> 'PHY'
                                                AND Iprefundmast.Ric_Cacr IN ('C', 'R')
                                                AND NVL (Iprefundmast.Ric_Cancel, 'N') = 'N'
                                                AND Iprefundmast.Rid_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Iprefundmast.Rid_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND IPREFUNDMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND Misincexpdtl.Dg_grcode = 46
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_2Ndasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Disbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurgery.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Cmn_Netamt, 0) - NVL (Cmn_Outcoll, 0)) Amt,
                                                SUM (0) Taxamt
                                        FROM Canbillmast,
                                                Disbillmast,
                                                Ipparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Canbillmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Ipparam.Ipc_Canteencode
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND Disbillmast.Mh_code = Ipparam.Mh_Code
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Canbillmast.Cmc_Cancel, 'N') = 'N'
                                                AND Canbillmast.Cmc_Cacr = 'I'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Operation, 0) - (NVL (Patsurgery.Srn_Operdis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_OPERTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Operation_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Oper
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Patsurgery.Srn_Operation, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                NVL (Srn_Theater, 0) - (NVL (Patsurgery.Srn_Theardis, 0)))
                                                Amt,
                                                SUM (NVL (PATSURGERY.SRN_THEATTOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Patsurgery.Theater_Opslno = Opbillmast.Opc_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Ther
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Patsurgery.Srn_Theater, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Chief, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Chief_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Chief
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Patsurgery.Srn_Chief, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_1Stasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D1Stasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_1Stasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Patsurgery.Srn_1Stasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_2Ndasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D2Ndasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_2Ndasst
                                                AND Procategory.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Patsurgery.Srn_2Ndasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_3Rdasst, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.D3Rdasst_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_3Rdasst
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Patsurgery.Srn_3Rdasst, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Guest, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Guest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Guest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Patsurgery.Srn_Guest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest, 0) - NVL (Srn_Antdis, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Patsurgery.Srn_Antest, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Srn_Antest2, 0)) Amt,
                                                SUM (NVL (PATSURGERYRESOURCESDETL.SRN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Opparam,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory,
                                                PATSURGERYRESOURCESDETL
                                        WHERE     Patsurgery.Antest2_Opslno = Opbillmast.Opc_Slno
                                                AND PATSURGERYRESOURCESDETL.SR_SLNO = Patsurgery.SR_SLNO
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Opparam.Opc_Anest2
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Patsurgery.Srn_Antest2, 0) > 0
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Patsurother.Pdn_Amount, 0)) Amt,
                                                SUM (NVL (PATSUROTHER.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurother,
                                                Prodescription,
                                                Progroup,
                                                Procategory
                                        WHERE     Patsurother.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurother.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Patsurother.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurother.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Patsurdetl.Srn_Amount - NVL (Patsurdetl.Srn_Discount, 0))
                                                Amt,
                                                SUM (NVL (patsurdetl.PSN_TOTTAX, 0)) Taxamt
                                        FROM Opbillmast,
                                                Patsurgery,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Patsurdetl,
                                                Procategory
                                        WHERE     Patsurdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Patsurdetl.Sr_Slno = Patsurgery.Sr_Slno
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Patsurdetl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Patsurgery.Src_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Patsurgery.IP_NO NOT IN (${ipNumberList})
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                                AND NVL (Patsurdetl.Src_Cancel, 'N') = 'N'
                                        GROUP BY Procategory.Pc_Code, Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Receiptmast.Rpc_Cancel, 'N') <> 'C'
                                                AND Receiptmast.RPC_COLLCNCODE IS NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.Rpd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.Rpd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (Receiptdetl.Rpn_Netamt, 0)) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND Receiptmast.RPC_COLLCNCODE IS NOT NULL
                                                AND Receiptmast.Rpc_Cacr IN ('C', 'R')
                                                AND Receiptmast.RPD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Receiptmast.RPD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Receiptdetl.Rpn_Netamt) Amt,
                                                SUM (NVL (RECEIPTDETL.RPN_TOTTAX, 0)) Taxamt
                                        FROM Receiptdetl,
                                                Receiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                procategory
                                        WHERE     Receiptmast.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Receiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND Receiptmast.Rpc_Cancel IS NULL
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Receiptmast.Rpc_Cacr = 'O'
                                                AND Opbillmast.Opc_cacr <> 'M'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND RECEIPTMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Refundreceiptmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptdetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptdetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                Refundreceiptmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptmast.Rfc_Slno = Refundreceiptdetl.Rfc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND Refundreceiptmast.RFC_RETCNCODE IS NOT NULL
                                                AND Refundreceiptmast.Rfc_Cancel IS NULL
                                                AND Refundreceiptmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundreceiptmast.RFD_RETDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundreceiptmast.RFD_RETDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND REFUNDRECEIPTMAST.MH_CODE IN
                                                        (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundreceiptdetl.Rpn_Netamt) * -1 Amt,
                                                SUM (NVL (refundreceiptdetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundreceiptdetl,
                                                refundreceiptmast,
                                                Receiptdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Refundreceiptdetl.Rpc_Slno = Receiptdetl.Rpc_Slno
                                                AND Refundreceiptdetl.Rpc_Cnt = Receiptdetl.Rpc_Cnt
                                                AND REFUNDRECEIPTMAST.Rfc_Slno = REFUNDRECEIPTDETL.Rfc_Slno
                                                AND Receiptdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundreceiptdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundreceiptdetl.Rfc_Cancel, 'N') = 'N'
                                                AND REFUNDRECEIPTMAST.RFC_CAcr IN ('O')
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') <> 'C'
                                                AND billmast.BMC_COLLCNCODE IS NULL
                                                AND Billmast.Bmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.Bmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billmast,
                                                Billdetl,
                                                Misincexpdtl,
                                                Prodescription,
                                                Progroup,
                                                Misincexpgroup,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Progroup.Pc_Code = Misincexpdtl.Pc_Code
                                                AND Misincexpdtl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND billmast.BMC_COLLCNCODE IS NOT NULL
                                                AND Billmast.Bmc_Cacr IN ('C', 'R')
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND Billmast.BMD_COLLDATE >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.BMD_COLLDATE <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Opbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'O'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (
                                                (Billdetl.Pdn_Rate * Pdn_Qty)
                                                - NVL (Billdetl.Bmn_Disamt, 0))
                                                Amt,
                                                SUM (NVL (BILLDETL.BDN_TOTTAX, 0)) Taxamt
                                        FROM Billdetl,
                                                Billmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Disbillmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Billdetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Billmast.Bmc_Cacr = 'I'
                                                AND NVL (Billmast.Bmc_Cancel, 'N') = 'N'
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                                Refundbillmast,
                                                Prodescription,
                                                Progroup,
                                                Misincexpdtl,
                                                Misincexpgroup,
                                                Billmast,
                                                Procategory
                                        WHERE     Billmast.Bmc_Slno = Refundbillmast.Bmc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.Dg_Grcode = Misincexpgroup.Dg_Grcode
                                                AND Misincexpdtl.Dg_Type = 'R'
                                                AND Misincexpdtl.Pc_Code = Progroup.Pc_Code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Refundbillmast.Rfc_Cancel, 'N') <> 'C'
                                                AND Refundbillmast.Rfc_Cacr IN ('C', 'R')
                                                AND Refundbilldetl.Rfd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Refundbilldetl.Rfd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Refundbilldetl,
                                                Refundbillmast,
                                                Billdetl,
                                                Opbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Refundbilldetl.Bmc_Slno = Billdetl.Bmc_Slno
                                                AND Billdetl.Opc_Slno = Opbillmast.Opc_Slno
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Refundbilldetl.Bmc_Cnt = Billdetl.Bmc_Cnt
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_Code
                                                AND Prodescription.Pg_Code = Progroup.Pg_Code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND Refundbillmast.Rfc_Cacr IN ('O')
                                                AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Opbillmast.Opc_Cacr <> 'M'
                                                AND Opbillmast.Opd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Opbillmast.Opd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (Refundbilldetl.Rfn_Netamt) * -1 Amt,
                                                SUM (NVL (refundbilldetl.RFN_TOTTAX, 0)) * -1 Taxamt
                                        FROM Billmast,
                                                Refundbilldetl,
                                                Refundbillmast,
                                                Disbillmast,
                                                Prodescription,
                                                Progroup,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Billmast.Bmc_Slno = Refundbilldetl.Bmc_Slno
                                                AND Billmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Refundbilldetl.Pd_Code = Prodescription.Pd_code
                                                AND Prodescription.Pg_code = Progroup.Pg_code
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = progroup.pc_code
                                                AND Refundbillmast.Rfc_Slno = Refundbilldetl.Rfc_Slno
                                                AND Progroup.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND NVL (Refundbilldetl.Rfc_Cancel, 'N') = 'N'
                                                AND Refundbillmast.Rfc_Cacr IN ('I')
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Billmast.IP_NO NOT IN (${ipNumberList})
                                                AND BILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc
                                        UNION ALL
                                        SELECT Procategory.Pcc_Desc,
                                                Procategory.Pc_Code AS Code,
                                                SUM (NVL (DSN_PACKAGEADJAMT, 0)) Amt,
                                                SUM (0) Taxamt
                                        FROM Disbillmast,
                                                Disbilldetl,
                                                Procategory,
                                                Misincexpdtl,
                                                Misincexpgroup
                                        WHERE     Disbillmast.dmc_Slno = Disbilldetl.dmc_Slno
                                                AND Misincexpdtl.dg_grcode = Misincexpgroup.dg_grcode
                                                AND Misincexpdtl.Dg_type = 'R'
                                                AND Misincexpdtl.Pc_code = Disbilldetl.pc_code
                                                AND Disbilldetl.Pc_Code = Procategory.Pc_Code
                                                AND Misincexpdtl.Dg_Grcode = 46
                                                AND NVL (Disbillmast.Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Disbillmast.dmd_date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.dmd_date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.IP_NO NOT IN (${ipNumberList})
                                        GROUP BY Procategory.Pc_Code, Procategory.Pcc_Desc)
                                GROUP BY Code, Pcc_Desc
                                HAVING SUM (Amt) <> 0
                                ORDER BY Pcc_Desc`;
    try {
      const result = await conn_ora.execute(sql, {}, {outFormat: oracledb.OUT_FORMAT_OBJECT});
      callBack(err, result.rows);
    } catch (error) {
      console.log(error);
    } finally {
      if (conn_ora) await conn_ora.close();
    }
  },
  pharmacyIncomePart1: async (data, callBack) => {
    let conn_ora = await getTmcConnection();

    const ipNumberList = data.ptno.join(",");
    const fromDate = data.from;
    const toDate = data.to;

    const sql = `SELECT Bm_No,
                                Bmc_Slno,
                                Bmd_Date,
                                Pt_No,
                                INITCAP (Ptc_Ptname) Ptc_Ptname,
                                SUM (Amt) Amt,
                                SUM (tax) tax
                        FROM (  SELECT Pbillmast.Bm_No,
                                        Pbillmast.Bmc_Slno,
                                        Pbillmast.Bmd_Date,
                                        Pbillmast.Pt_No,
                                        Patient.Ptc_Ptname,
                                        SUM (NVL (Pbilldetl.Bdn_Amount, 0)) Amt,
                                        SUM (
                                            NVL (PBILLDETL.BMN_CESS, 0)
                                            + NVL (PBILLDETL.BMN_SALETAX, 0))
                                            tax
                                    FROM Pbillmast, Pbilldetl, Patient
                                    WHERE     Pbilldetl.Bmc_Slno = Pbillmast.Bmc_Slno
                                        AND Pbillmast.Pt_No = Patient.Pt_No(+)
                                        AND NVL (Pbillmast.Bmc_Cancel, 'N') = 'N'
                                        AND Pbillmast.Bmc_Cacr IN ('C', 'R')
                                        AND BMC_COLLCNCODE IS NULL
                                        AND Pbillmast.Bmd_Date >=
                                                TO_DATE ('${fromDate}',
                                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Pbillmast.Bmd_Date <=
                                                TO_DATE ('${toDate}',
                                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND pbillmast.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                GROUP BY Pbillmast.Bm_No,
                                        Pbillmast.Bmc_Slno,
                                        Pbillmast.Bmd_Date,
                                        Pbillmast.Pt_No,
                                        Patient.Ptc_Ptname
                                UNION ALL
                                SELECT Pbilldetl.Bm_no,
                                        Pbilldetl.Bmc_Slno,
                                        Pbilldetl.Bmd_Date,
                                        Mretmast.Pt_No,
                                        Patient.Ptc_Ptname,
                                        SUM (
                                            NVL (Mretdetl.Mrn_Amount, 0) - NVL (Mretdetl.Mrn_Disamt, 0))
                                        * -1
                                            Amt,
                                        SUM (
                                            NVL (Mretdetl.MRN_SALETAX, 0) + NVL (Mretdetl.MRN_CESS, 0))
                                        * -1
                                            tax
                                    FROM Mretdetl,
                                        Pbilldetl,
                                        Patient,
                                        Mretmast
                                    WHERE     Mretmast.Mrc_slno = Mretdetl.Mrc_Slno
                                        AND Patient.Pt_No(+) = Mretmast.Pt_No
                                        AND Pbilldetl.Bmc_Slno = Mretdetl.Bmc_Slno
                                        AND Pbilldetl.It_Code = Mretdetl.It_Code
                                        AND Pbilldetl.Itc_Docno = Mretdetl.Itc_Docno
                                        AND Pbilldetl.Itc_Doctype = Mretdetl.Itc_Doctype
                                        AND Pbilldetl.Itc_Slno = Mretdetl.Itc_Slno
                                        AND NVL (Mretdetl.Mrc_Cancel, 'N') = 'N'
                                        AND Mretdetl.Mrc_Cacr IN ('C', 'R')
                                        AND MRC_RETCNCODE IS NULL
                                        AND NVL (MretMAST.Mrc_Cancel, 'N') = 'N'
                                        AND Mretdetl.Mrd_Date >=
                                                TO_DATE ('${fromDate}',
                                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Mretdetl.Mrd_Date <=
                                                TO_DATE ('${toDate}',
                                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND MRETMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                GROUP BY Pbilldetl.Bm_no,
                                        Pbilldetl.Bmc_Slno,
                                        Pbilldetl.Bmd_Date,
                                        Mretmast.Pt_No,
                                        Patient.Ptc_Ptname
                                UNION ALL
                                SELECT Pbillmast.Bm_No,
                                        Pbillmast.Bmc_Slno,
                                        Pbillmast.Bmd_Date,
                                        Pbillmast.Pt_No,
                                        Patient.Ptc_Ptname,
                                        SUM (NVL (Pbilldetl.Bdn_Amount, 0)) Amt,
                                        SUM (
                                            NVL (PBILLDETL.BMN_CESS, 0)
                                            + NVL (PBILLDETL.BMN_SALETAX, 0))
                                            tax
                                    FROM Pbillmast, Pbilldetl, Patient
                                    WHERE     Pbilldetl.Bmc_Slno = Pbillmast.Bmc_Slno
                                        AND Pbillmast.Pt_No = Patient.Pt_No(+)
                                        AND NVL (Pbillmast.Bmc_Cancel, 'N') = 'N'
                                        AND Pbillmast.Bmc_Cacr IN ('C', 'R')
                                        AND BMC_COLLCNCODE IS NOT NULL
                                        AND Pbillmast.BMD_COLLDATE >=
                                                TO_DATE ('${fromDate}',
                                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Pbillmast.BMD_COLLDATE <=
                                                TO_DATE ('${toDate}',
                                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND pbillmast.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                GROUP BY Pbillmast.Bm_No,
                                        Pbillmast.Bmc_Slno,
                                        Pbillmast.Bmd_Date,
                                        Pbillmast.Pt_No,
                                        Patient.Ptc_Ptname
                                UNION ALL
                                SELECT Pbilldetl.Bm_no,
                                        Pbilldetl.Bmc_Slno,
                                        Pbilldetl.Bmd_Date,
                                        Mretmast.Pt_No,
                                        Patient.Ptc_Ptname,
                                        SUM (
                                            NVL (Mretdetl.Mrn_Amount, 0) - NVL (Mretdetl.Mrn_Disamt, 0))
                                        * -1
                                            Amt,
                                        SUM (
                                            NVL (Mretdetl.MRN_SALETAX, 0) + NVL (Mretdetl.MRN_CESS, 0))
                                        * -1
                                            tax
                                    FROM Mretdetl,
                                        Pbilldetl,
                                        Patient,
                                        Mretmast
                                    WHERE     Mretmast.Mrc_slno = Mretdetl.Mrc_Slno
                                        AND Patient.Pt_No(+) = Mretmast.Pt_No
                                        AND Pbilldetl.Bmc_Slno = Mretdetl.Bmc_Slno
                                        AND Pbilldetl.It_Code = Mretdetl.It_Code
                                        AND Pbilldetl.Itc_Docno = Mretdetl.Itc_Docno
                                        AND Pbilldetl.Itc_Doctype = Mretdetl.Itc_Doctype
                                        AND Pbilldetl.Itc_Slno = Mretdetl.Itc_Slno
                                        AND NVL (Mretdetl.Mrc_Cancel, 'N') = 'N'
                                        AND NVL (MretMAST.Mrc_Cancel, 'N') = 'N'
                                        AND Mretdetl.Mrc_Cacr IN ('C', 'R')
                                        AND MRC_RETCNCODE IS NOT NULL
                                        AND Mretmast.MRD_RETDATE >=
                                                TO_DATE ('${fromDate}',
                                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND Mretmast.MRD_RETDATE <=
                                                TO_DATE ('${toDate}',
                                                        'dd/MM/yyyy hh24:mi:ss')
                                        AND MRETMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                GROUP BY Pbilldetl.Bm_no,
                                        Pbilldetl.Bmc_Slno,
                                        Pbilldetl.Bmd_Date,
                                        Mretmast.Pt_No,
                                        Patient.Ptc_Ptname)
                        GROUP BY Bm_No,
                                Bmc_Slno,
                                Bmd_Date,
                                Pt_No,
                                Ptc_Ptname
                        HAVING SUM (Amt) <> 0
                        ORDER BY Bmd_Date`;
    try {
      const result = await conn_ora.execute(sql, {}, {outFormat: oracledb.OUT_FORMAT_OBJECT});
      callBack(err, result.rows);
    } catch (error) {
      console.log(error);
    } finally {
      if (conn_ora) await conn_ora.close();
    }
  },
  pharmacyIncomePart2: async (data, callBack) => {
    let conn_ora = await getTmcConnection();

    const ipNumberList = data.ptno.join(",");
    const fromDate = data.from;
    const toDate = data.to;

    const sql = `SELECT Op_No,
                                    Opc_Slno,
                                    Opd_Date,
                                    Pt_No,
                                    INITCAP (Ptc_Ptname) Ptc_Ptname,
                                    SUM (Amt) Amt,
                                    SUM (tax) tax
                            FROM (  SELECT Opbillmast.Op_No,
                                            Opbillmast.Opc_Slno,
                                            Opbillmast.Opd_Date,
                                            Opbillmast.Pt_No,
                                            Patient.Ptc_Ptname,
                                            SUM (NVL (Pbilldetl.Bdn_Amount, 0)) Amt,
                                            SUM (
                                                NVL (PBILLDETL.BMN_CESS, 0)
                                                + NVL (PBILLDETL.BMN_SALETAX, 0))
                                                tax
                                        FROM Pbillmast,
                                            Pbilldetl,
                                            Opbillmast,
                                            Patient
                                        WHERE     Pbilldetl.Bmc_Slno = Pbillmast.Bmc_Slno
                                            AND Opbillmast.Pt_No = Patient.Pt_No(+)
                                            AND Pbilldetl.Opc_Slno = Opbillmast.Opc_Slno
                                            AND Opbillmast.Opc_Cacr <> 'M'
                                            AND NVL (Pbillmast.Bmc_Cancel, 'N') = 'N'
                                            AND Pbillmast.Bmc_Cacr = 'O'
                                            AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                            AND Opbillmast.Opd_Date >=
                                                    TO_DATE ('${fromDate}',
                                                            'dd/MM/yyyy hh24:mi:ss')
                                            AND Opbillmast.Opd_Date <=
                                                    TO_DATE ('${toDate}',
                                                            'dd/MM/yyyy hh24:mi:ss')
                                            AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                    GROUP BY Opbillmast.Op_No,
                                            Opbillmast.Opc_Slno,
                                            Opbillmast.Opd_Date,
                                            Opbillmast.Pt_No,
                                            Patient.Ptc_Ptname
                                    UNION ALL
                                    SELECT Opbillmast.Op_No,
                                            Opbillmast.Opc_Slno,
                                            Opbillmast.Opd_Date,
                                            Opbillmast.Pt_No,
                                            Patient.Ptc_Ptname,
                                            SUM (
                                                NVL (Mretdetl.Mrn_Amount, 0) - NVL (mretdetl.Mrn_Disamt, 0))
                                            * -1
                                                Amt,
                                            SUM (
                                                NVL (Mretdetl.MRN_SALETAX, 0) + NVL (Mretdetl.MRN_CESS, 0))
                                            * -1
                                                tax
                                        FROM Mretdetl,
                                            Pbilldetl,
                                            Opbillmast,
                                            Patient,
                                            mretmast
                                        WHERE     Pbilldetl.Opc_Slno = Opbillmast.Opc_Slno
                                            AND Opbillmast.Pt_No = Patient.Pt_No(+)
                                            AND Pbilldetl.Bmc_Slno = Mretdetl.Bmc_Slno
                                            AND Pbilldetl.It_Code = Mretdetl.It_Code
                                            AND Pbilldetl.Itc_Docno = Mretdetl.Itc_Docno
                                            AND Pbilldetl.Itc_Doctype = Mretdetl.Itc_Doctype
                                            AND Pbilldetl.Itc_Slno = Mretdetl.Itc_Slno
                                            AND Opbillmast.Opc_Cacr <> 'M'
                                            AND NVL (Mretdetl.Mrc_Cancel, 'N') = 'N'
                                            AND Mretdetl.Mrc_Cacr IN ('O')
                                            AND mretmast.mrc_slno = mretdetl.mrc_slno
                                            AND NVL (MretMAST.Mrc_Cancel, 'N') = 'N'
                                            AND NVL (Opbillmast.Opn_Cancel, 'N') = 'N'
                                            AND Opbillmast.Opd_Date >=
                                                    TO_DATE ('${fromDate}',
                                                            'dd/MM/yyyy hh24:mi:ss')
                                            AND Opbillmast.Opd_Date <=
                                                    TO_DATE ('${toDate}',
                                                            'dd/MM/yyyy hh24:mi:ss')
                                            AND OPBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                    GROUP BY Opbillmast.Op_No,
                                            Opbillmast.Opc_Slno,
                                            Opbillmast.Opd_Date,
                                            Opbillmast.Pt_No,
                                            Patient.Ptc_Ptname)
                            GROUP BY Op_No,
                                    Opc_Slno,
                                    Opd_Date,
                                    Pt_No,
                                    Ptc_Ptname
                            HAVING SUM (Amt) <> 0
                            ORDER BY Opd_Date`;
    try {
      const result = await conn_ora.execute(sql, {}, {outFormat: oracledb.OUT_FORMAT_OBJECT});
      callBack(err, result.rows);
    } catch (error) {
      console.log(error);
    } finally {
      if (conn_ora) await conn_ora.close();
    }
  },
  pharmacyIncomePart3: async (data, callBack) => {
    let conn_ora = await getTmcConnection();

    const ipNumberList = data.ptno.join(",");
    const fromDate = data.from;
    const toDate = data.to;

    const sql = `SELECT Iprefundmast.Ri_No,
                                Iprefundmast.Ric_Slno,
                                Iprefundmast.Rid_Date,
                                Patient.Pt_No,
                                INITCAP (Ptc_Ptname) Ptc_Ptname,
                                SUM (NVL (Iprefunditemdetl.Rin_Netamt, 0)) * -1 Amt,
                                SUM (NVL (Iprefunditemdetl.RIN_TOTTAX, 0)) * -1 tax
                        FROM Iprefundmast, Iprefunditemdetl, Patient
                        WHERE     Iprefunditemdetl.Ric_Slno = Iprefundmast.Ric_Slno
                                AND Iprefundmast.Pt_No = Patient.Pt_No(+)
                                AND NVL (Iprefundmast.Ric_Cancel, 'N') = 'N'
                                AND Iprefundmast.Ric_Cacr IN ('C', 'R')
                                AND Iprefunditemdetl.Ric_Type = 'PHY'
                                AND Iprefundmast.Rid_Date >=
                                    TO_DATE ('${fromDate}', 'dd/MM/yyyy hh24:mi:ss')
                                AND Iprefundmast.Rid_Date <=
                                    TO_DATE ('${toDate}', 'dd/MM/yyyy hh24:mi:ss')
                                AND IPREFUNDMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                        GROUP BY Iprefundmast.Ri_No,
                                Iprefundmast.Ric_Slno,
                                Iprefundmast.Rid_Date,
                                Patient.Pt_No,
                                Ptc_Ptname`;

    try {
      const result = await conn_ora.execute(sql, {}, {outFormat: oracledb.OUT_FORMAT_OBJECT});
      callBack(err, result.rows);
    } catch (error) {
      console.log(error);
    } finally {
      if (conn_ora) await conn_ora.close();
    }
  },
  pharmacyIncomePart4: async (data, callBack) => {
    let conn_ora = await getTmcConnection();

    const ipNumberList = data.ptno.join(",");
    const fromDate = data.from;
    const toDate = data.to;

    const sql = `SELECT Dm_No,
                                        Dmc_Slno,
                                        Dmd_Date,
                                        Pt_No,
                                        INITCAP (Ptc_Ptname) Ptc_Ptname,
                                        SUM (Amt) Amt,
                                        SUM (tax) tax
                                FROM (  SELECT Disbillmast.Dm_No,
                                                Disbillmast.Dmc_Slno,
                                                Disbillmast.Dmd_Date,
                                                Disbillmast.Pt_No,
                                                Patient.Ptc_Ptname,
                                                SUM (NVL (Pbilldetl.Bdn_amount, 0)) Amt,
                                                SUM (
                                                NVL (PBILLDETL.BMN_CESS, 0)
                                                + NVL (PBILLDETL.BMN_SALETAX, 0))
                                                tax
                                        FROM Pbillmast,
                                                Disbillmast,
                                                Patient,
                                                pbilldetl
                                        WHERE     pbillmast.bmc_slno = pbilldetl.bmc_slno
                                                AND Pbillmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Disbillmast.Pt_No = Patient.Pt_No(+)
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND NVL (Pbillmast.Bmc_Cancel, 'N') = 'N'
                                                AND Pbillmast.Bmc_Cacr = 'I'
                                                AND NVL (Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})    
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Disbillmast.Dm_No,
                                                Disbillmast.Dmc_Slno,
                                                Disbillmast.Dmd_Date,
                                                Disbillmast.Pt_No,
                                                Patient.Ptc_Ptname
                                        UNION ALL
                                        SELECT Disbillmast.Dm_No,
                                                Disbillmast.Dmc_Slno,
                                                Disbillmast.Dmd_Date,
                                                Disbillmast.Pt_No,
                                                Patient.Ptc_Ptname,
                                                SUM (
                                                NVL (Mretdetl.Mrn_Amount, 0) - NVL (mretdetl.Mrn_Disamt, 0))
                                                * -1
                                                Amt,
                                                SUM (
                                                NVL (Mretdetl.MRN_SALETAX, 0) + NVL (Mretdetl.MRN_CESS, 0))
                                                * -1
                                                tax
                                        FROM Mretdetl,
                                                Pbillmast,
                                                Disbillmast,
                                                Patient,
                                                mretmast
                                        WHERE     Pbillmast.Bmc_Slno = Mretdetl.Bmc_Slno
                                                AND Pbillmast.Dmc_Slno = Disbillmast.Dmc_Slno
                                                AND Disbillmast.Pt_No = Patient.Pt_No(+)
                                                AND Disbillmast.Dmc_Cacr <> 'M'
                                                AND Pbillmast.Bmc_Cacr = 'I'
                                                AND Mretdetl.Mrc_Cacr IN ('I')
                                                AND NVL (Mretdetl.Mrc_Cancel, 'N') = 'N'
                                                AND NVL (Dmc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmd_Date >=
                                                        TO_DATE ('${fromDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND mretmast.mrc_slno = mretdetl.mrc_slno
                                                AND NVL (MretMAST.Mrc_Cancel, 'N') = 'N'
                                                AND Disbillmast.Dmd_Date <=
                                                        TO_DATE ('${toDate}',
                                                                'dd/MM/yyyy hh24:mi:ss')
                                                AND DISBILLMAST.IP_NO NOT IN (${ipNumberList})  
                                                AND DISBILLMAST.MH_CODE IN (SELECT MH_CODE FROM multihospital)
                                        GROUP BY Disbillmast.Dm_No,
                                                Disbillmast.Dmc_Slno,
                                                Disbillmast.Dmd_Date,
                                                Disbillmast.Pt_No,
                                                Patient.Ptc_Ptname)
                                GROUP BY Dm_No,
                                        Dmc_Slno,
                                        Dmd_Date,
                                        Pt_No,
                                        Ptc_Ptname
                                HAVING SUM (Amt) <> 0
                                ORDER BY Dmd_Date`;
    try {
      const result = await conn_ora.execute(sql, {}, {outFormat: oracledb.OUT_FORMAT_OBJECT});
      callBack(err, result.rows);
    } catch (error) {
      console.log(error);
    } finally {
      if (conn_ora) await conn_ora.close();
    }
  },
};
